import{a as m,b as u}from"./chunk-2LVZO5F4.js";import{Gb as p,Hb as g,R as i,ab as a,j as r,jb as h,m as n,p as t}from"./chunk-D4YDXMC2.js";var T=(()=>{class s{constructor(){this.notificationService=t(p),this.http=t(a),this.tokenStorage=t(m),this.router=t(h),this.api=t(g),this.userService=t(u),this.host=this.api.host,this.isLoggedIn=i(this.tokenStorage.getToken()!==null),this.isAdmin=i(this.tokenStorage.getType()==="admin"),this.userPermissions=i(this.tokenStorage.getPermissions())}login(o){return this.http.post(`${this.host()}/auth/login`,{username:o.username,password:o.password}).pipe(r(e=>{this.tokenStorage.saveUser(e.username),this.tokenStorage.saveType(e.user_type),this.tokenStorage.saveToken(e.token),this.tokenStorage.saveName(e.first_name),this.tokenStorage.savePermissions(e.permissions),this.userService.loggedInUser.set(e.username),this.userService.loggedInName.set(e.first_name),this.userService.userType.set(e.user_type),this.isLoggedIn.set(!0),this.isAdmin.set(e.user_type==="admin"),this.userPermissions.set(e.permissions),this.router.navigate(["/home"])}))}logout(){this.userService.resetUser(),window.sessionStorage.clear(),this.isLoggedIn.set(!1),this.isAdmin.set(!1),this.userPermissions.set(null),this.router.navigate(["/login"]),window.location.reload()}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{T as a};
