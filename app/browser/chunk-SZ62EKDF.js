import{a as Lt,b as Bt,c as Ht,d as Ot}from"./chunk-FMOYRNA2.js";import{a as Ve}from"./chunk-HUAQCBA6.js";import{a as Ee,b as Mt}from"./chunk-ZAV7LROA.js";import{a as we,b as Tt}from"./chunk-FBBXAICZ.js";import{a as qt,b as zt}from"./chunk-MGDARQZO.js";import{a as Rt}from"./chunk-4ID2WBEC.js";import{a as Te}from"./chunk-SNM2CLGW.js";import{a as Nt}from"./chunk-5G6QHU5I.js";import{a as J,b as Pt}from"./chunk-R6KW2DC6.js";import{a as ye}from"./chunk-DC3T4MAL.js";import{b as P}from"./chunk-MAZQTZTP.js";import"./chunk-QMM6CLJV.js";import"./chunk-2LVZO5F4.js";import"./chunk-CHNOQELU.js";import{a as vt,b as St}from"./chunk-ZTKZ5H54.js";import{C as Dt,D as Ft,E as Ie,i as ke,j as Et,l as ce,m as Vt,t as K,w as Y}from"./chunk-CGG3ICFJ.js";import{$ as ge,Aa as v,Ab as gt,Ac as je,B as ie,Ba as x,Bc as Z,Ca as fe,Cc as xe,Db as F,E as Ke,Eb as Be,Ga as rt,Gb as ft,J as Ye,Ja as k,Jb as re,K as a,Ka as I,L as ne,La as at,Lb as T,Na as st,Nb as A,O as Je,Oa as $,Ob as j,Pa as lt,Pb as ht,Ra as ct,Rb as Ce,Sa as mt,T as Xe,Ta as z,Tb as G,U as _,Ub as Q,V as H,Va as N,Vb as W,W as s,Wa as pt,Wb as bt,Xa as dt,Xb as ae,Ya as ut,Yb as yt,Z as O,Za as he,Zb as Ct,_ as $e,_a as be,_b as se,a as _e,aa as n,ba as o,ca as f,da as Ne,ea as Me,ec as wt,fa as pe,fc as xt,ga as b,gc as ve,ha as g,hc as U,ia as m,ib as _t,ic as Se,ja as et,jc as le,ka as tt,kc as kt,la as it,ma as nt,n as ee,na as X,nc as It,oa as L,oc as He,p as C,pa as B,pb as Le,q as S,qa as q,qc as Oe,r as te,ra as l,sa as w,sb as de,sc as qe,ta as R,tc as ze,ub as oe,va as E,vc as Ae,w as d,wa as V,x as u,xa as D,za as ot}from"./chunk-D4YDXMC2.js";import"./chunk-TSRGIXR5.js";var ei=["*"],ti=(t,c,e,r,i,p)=>({"p-sidebar":!0,"p-sidebar-active":t,"p-sidebar-left":c,"p-sidebar-right":e,"p-sidebar-top":r,"p-sidebar-bottom":i,"p-sidebar-full":p}),ii=(t,c)=>({transform:t,transition:c}),ni=t=>({value:"visible",params:t});function oi(t,c){t&1&&pe(0)}function ri(t,c){if(t&1&&(Ne(0),_(1,oi,1,0,"ng-container",5),Me()),t&2){let e=m(2);a(),s("ngTemplateOutlet",e.headlessTemplate)}}function ai(t,c){t&1&&pe(0)}function si(t,c){t&1&&f(0,"TimesIcon",13),t&2&&(s("styleClass","p-sidebar-close-icon"),H("data-pc-section","closeicon"))}function li(t,c){}function ci(t,c){t&1&&_(0,li,0,0,"ng-template")}function mi(t,c){if(t&1&&(n(0,"span",14),_(1,ci,1,0,null,5),o()),t&2){let e=m(4);H("data-pc-section","closeicon"),a(),s("ngTemplateOutlet",e.closeIconTemplate)}}function pi(t,c){if(t&1){let e=b();n(0,"button",10),g("click",function(i){d(e);let p=m(3);return u(p.close(i))})("keydown.enter",function(i){d(e);let p=m(3);return u(p.close(i))}),_(1,si,1,2,"TimesIcon",11)(2,mi,2,2,"span",12),o()}if(t&2){let e=m(3);H("aria-label",e.ariaCloseLabel)("data-pc-section","closebutton")("data-pc-group-section","iconcontainer"),a(),s("ngIf",!e.closeIconTemplate),a(),s("ngIf",e.closeIconTemplate)}}function di(t,c){t&1&&pe(0)}function ui(t,c){t&1&&pe(0)}function _i(t,c){if(t&1&&(Ne(0),n(1,"div",15),_(2,ui,1,0,"ng-container",5),o(),Me()),t&2){let e=m(3);a(),H("data-pc-section","footer"),a(),s("ngTemplateOutlet",e.footerTemplate)}}function gi(t,c){if(t&1&&(n(0,"div",6),_(1,ai,1,0,"ng-container",5)(2,pi,3,5,"button",7),o(),n(3,"div",8),tt(4),_(5,di,1,0,"ng-container",5),o(),_(6,_i,3,2,"ng-container",9)),t&2){let e=m(2);H("data-pc-section","header"),a(),s("ngTemplateOutlet",e.headerTemplate),a(),s("ngIf",e.showCloseIcon),a(),H("data-pc-section","content"),a(2),s("ngTemplateOutlet",e.contentTemplate),a(),s("ngIf",e.footerTemplate)}}function fi(t,c){if(t&1){let e=b();n(0,"div",3,0),g("@panelState.start",function(i){d(e);let p=m();return u(p.onAnimationStart(i))})("@panelState.done",function(i){d(e);let p=m();return u(p.onAnimationEnd(i))})("keydown",function(i){d(e);let p=m();return u(p.onKeyDown(i))}),_(2,ri,2,1,"ng-container",4)(3,gi,7,6,"ng-template",null,1,at),o()}if(t&2){let e=q(4),r=m();$e(r.styleClass),s("ngClass",rt(9,ti,r.visible,r.position==="left"&&!r.fullScreen,r.position==="right"&&!r.fullScreen,r.position==="top"&&!r.fullScreen,r.position==="bottom"&&!r.fullScreen,r.fullScreen))("@panelState",x(19,ni,fe(16,ii,r.transformOptions,r.transitionOptions)))("ngStyle",r.style),H("data-pc-name","sidebar")("data-pc-section","root"),a(2),s("ngIf",r.headlessTemplate)("ngIfElse",e)}}var hi=ze([Oe({transform:"{{transform}}",opacity:0}),He("{{transition}}")]),bi=ze([He("{{transition}}",Oe({transform:"{{transform}}",opacity:0}))]),Fe=(()=>{class t{document;el;renderer;cd;config;appendTo;blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(e){this._visible=e}get position(){return this._position}set position(e){switch(this._position=e,e){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(e){this._fullScreen=e,e&&(this.transformOptions="none")}templates;onShow=new ie;onHide=new ie;visibleChange=new ie;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;maskClickListener;documentEscapeListener;animationEndListener;contentTemplate;headerTemplate;footerTemplate;closeIconTemplate;headlessTemplate;constructor(e,r,i,p,h){this.document=e,this.el=r,this.renderer=i,this.cd=p,this.config=h}ngAfterViewInit(){this.initialized=!0}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"closeicon":this.closeIconTemplate=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}onKeyDown(e){e.code==="Escape"&&this.hide(!1)}show(){this.autoZIndex&&de.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.modal&&this.enableModality(),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(e=!0){e&&this.onHide.emit({}),this.modal&&this.disableModality()}close(e){this.hide(!1),this.visibleChange.emit(!1),e.preventDefault()}enableModality(){let e=this.document.querySelectorAll(".p-sidebar-active"),i=e.length==1?String(parseInt(this.container.style.zIndex)-1):String(parseInt(e[0].style.zIndex)-1);this.mask||(this.mask=this.renderer.createElement("div"),this.renderer.setStyle(this.mask,"zIndex",i),se.addMultipleClasses(this.mask,"p-component-overlay p-sidebar-mask p-component-overlay p-component-overlay-enter"),this.dismissible&&(this.maskClickListener=this.renderer.listen(this.mask,"click",p=>{this.dismissible&&this.close(p)})),this.renderer.appendChild(this.document.body,this.mask),this.blockScroll&&se.blockBodyScroll())}disableModality(){this.mask&&(se.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyModal.bind(this)))}destroyModal(){this.unbindMaskClickListener(),this.mask&&this.renderer.removeChild(this.document.body,this.mask),this.blockScroll&&se.unblockBodyScroll(),this.unbindAnimationEndListener(),this.mask=null}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(e){switch(e.toState){case"void":this.hide(!0),de.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):se.appendChild(this.container,this.appendTo))}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(e,"keydown",r=>{r.which==27&&parseInt(this.container.style.zIndex)===de.get(this.container)&&this.close(r)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindGlobalListeners(){this.unbindMaskClickListener(),this.unbindDocumentEscapeListener()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.initialized=!1,this.visible&&this.modal&&this.destroyModal(),this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&de.clear(this.container),this.container=null,this.unbindGlobalListeners(),this.unbindAnimationEndListener()}static \u0275fac=function(r){return new(r||t)(ne(mt),ne(Ke),ne(Je),ne(st),ne(gt))};static \u0275cmp=S({type:t,selectors:[["p-sidebar"]],contentQueries:function(r,i,p){if(r&1&&nt(p,F,4),r&2){let h;L(h=B())&&(i.templates=h)}},hostAttrs:[1,"p-element"],inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",$],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",$],baseZIndex:[2,"baseZIndex","baseZIndex",lt],modal:[2,"modal","modal",$],dismissible:[2,"dismissible","dismissible",$],showCloseIcon:[2,"showCloseIcon","showCloseIcon",$],closeOnEscape:[2,"closeOnEscape","closeOnEscape",$],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[Xe],ngContentSelectors:ei,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["role","complementary",3,"ngClass","ngStyle","class","keydown",4,"ngIf"],["role","complementary",3,"keydown","ngClass","ngStyle"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],[1,"p-sidebar-header"],["type","button","class","p-sidebar-close p-sidebar-icon p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[1,"p-sidebar-content"],[4,"ngIf"],["type","button","pRipple","",1,"p-sidebar-close","p-sidebar-icon","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],["class","p-sidebar-close-icon",4,"ngIf"],[3,"styleClass"],[1,"p-sidebar-close-icon"],[1,"p-sidebar-footer"]],template:function(r,i){r&1&&(et(),_(0,fi,5,21,"div",2)),r&2&&s("ngIf",i.visible)},dependencies:()=>[z,N,dt,pt,wt,je],styles:[`@layer primeng{.p-sidebar{position:fixed;transition:transform .3s;display:flex;flex-direction:column}.p-sidebar-content{position:relative;overflow-y:auto;flex-grow:1}.p-sidebar-header{display:flex;align-items:center}.p-sidebar-footer{margin-top:auto}.p-sidebar-icon{display:flex;align-items:center;justify-content:center;margin-left:auto}.p-sidebar-left{top:0;left:0;width:20rem;height:100%}.p-sidebar-right{top:0;right:0;width:20rem;height:100%}.p-sidebar-top{top:0;left:0;width:100%;height:10rem}.p-sidebar-bottom{bottom:0;left:0;width:100%;height:10rem}.p-sidebar-full{width:100%;height:100%;top:0;left:0;-webkit-transition:none;transition:none}.p-sidebar-left.p-sidebar-sm,.p-sidebar-right.p-sidebar-sm{width:20rem}.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-md{width:40rem}.p-sidebar-left.p-sidebar-lg,.p-sidebar-right.p-sidebar-lg{width:60rem}.p-sidebar-top.p-sidebar-sm,.p-sidebar-bottom.p-sidebar-sm{height:10rem}.p-sidebar-top.p-sidebar-md,.p-sidebar-bottom.p-sidebar-md{height:20rem}.p-sidebar-top.p-sidebar-lg,.p-sidebar-bottom.p-sidebar-lg{height:30rem}@media screen and (max-width: 64em){.p-sidebar-left.p-sidebar-lg,.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-lg,.p-sidebar-right.p-sidebar-md{width:20rem}}}
`],encapsulation:2,data:{animation:[It("panelState",[qe("void => visible",[Ae(hi)]),qe("visible => void",[Ae(bi)])])]},changeDetection:0})}return t})(),At=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=te({type:t});static \u0275inj=ee({imports:[be,xt,Be,je,Be]})}return t})();var yi=()=>({width:"75vw"}),Ci=()=>({"1199px":"85vw","575px":"95vw"}),vi=()=>[10,15,50,100],Si=()=>["product_name","barcode"];function wi(t,c){t&1&&(n(0,"tr")(1,"th"),l(2,"Transaction #"),o(),n(3,"th"),l(4,"Datetime"),o(),n(5,"th"),l(6,"Type"),o(),n(7,"th"),l(8,"Quantity"),o()())}function xi(t,c){if(t&1&&(n(0,"tr",8)(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),f(6,"p-tag",9),o(),n(7,"td"),l(8),o()()),t&2){let e=c.$implicit,r=m(2);s("pSelectableRow",e),a(2),w(e.transaction_notes||"---"),a(2),w(e.transaction_datetime),a(2),s("value",e.transaction_type)("severity",r.getSeverity(e.transaction_type)),a(2),w(e.quantity)}}function ki(t,c){t&1&&(n(0,"tr")(1,"td",10),l(2,"No items yet!"),o()())}function Ii(t,c){if(t&1&&(n(0,"p-table",4,0),_(2,wi,9,0,"ng-template",5)(3,xi,9,6,"ng-template",6)(4,ki,3,0,"ng-template",7),o()),t&2){let e=m();s("value",e.stockHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",v(8,vi))("alwaysShowPaginator",!0)("globalFilterFields",v(9,Si))("filterDelay",0)}}function Ti(t,c){if(t&1){let e=b();n(0,"p-button",11),g("onClick",function(){d(e);let i=m();return u(i.closeDialog())}),o()}}var Re=(()=>{class t{constructor(){this.visible=!1,this.onClose=new ie,this.stockService=C(P),this.stockHistory=this.stockService.stockHistory}closeDialog(){this.visible=!1,this.onClose.emit()}fetchProductHistory(){this.stockService.fetchStockHistory(this.product_id)}getSeverity(e){switch(e){case"SALE":return"danger";case"SUPPLY":return"success";case"RETURN":return"success";case"DELETE":return"success";case"DISPOSE":return"danger";case"ADD":return"success";case"REMOVE":return"danger";default:return"contrast"}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["stock-transactions"]],inputs:{product_id:"product_id",visible:"visible"},outputs:{onClose:"onClose"},standalone:!0,features:[ot],decls:3,vars:11,consts:[["dt2",""],["position","top","header","Transaction History","styleClass","p-fluid",3,"visibleChange","onHide","onShow","modal","visible","breakpoints","closeOnEscape","closable","maximizable","dismissableMask"],["pTemplate","content"],["pTemplate","footer"],["styleClass","p-datatable-sm","dataKey","transaction_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"pSelectableRow"],[3,"value","severity"],["colspan","7"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"]],template:function(r,i){r&1&&(n(0,"p-dialog",1),D("visibleChange",function(h){return V(i.visible,h)||(i.visible=h),h}),g("onHide",function(){return i.closeDialog()})("onShow",function(){return i.fetchProductHistory()}),_(1,Ii,5,10,"ng-template",2)(2,Ti,1,0,"ng-template",3),o()),r&2&&(O(v(9,yi)),s("modal",!0),E("visible",i.visible),s("breakpoints",v(10,Ci))("closeOnEscape",!0)("closable",!0)("maximizable",!0)("dismissableMask",!0))},dependencies:[xe,Z,F,Se,U,Ie,K,Y,Bt,Lt]})}}return t})();var Pi=["tableSearch"],Ri=["itemName"],Ni=()=>[10,15,20,50,100],Mi=()=>["product_name","barcode"],me=t=>({"ng-invalid ng-dirty":t}),Li=()=>({width:"65vw"});function Bi(t,c){if(t&1){let e=b();n(0,"span",35),f(1,"i",36),n(2,"input",37,2),g("input",function(i){d(e),m();let p=q(8);return u(p.filterGlobal(i.target.value,"contains"))}),o()(),n(4,"p-button",38),g("onClick",function(){d(e);let i=m();return u(i.refreshTable())}),o(),n(5,"p-button",39),g("onClick",function(){d(e);let i=m();return u(i.openItemDialog("add"))}),o()}if(t&2){let e=m(),r=q(8);a(2),s("value",r.filters.global==null?null:r.filters.global.value),a(2),s("loading",e.tableLoading())}}function Hi(t,c){if(t&1){let e=b();n(0,"p-button",40),g("onClick",function(){d(e);let i=m();return u(i.openStockDialog())}),o(),n(1,"p-button",41),g("onClick",function(){d(e);let i=m();return u(i.fetchHistory())}),o()}if(t&2){let e=m();s("disabled",!e.selectedProduct()||e.selectedProduct().stock_management==0),a(),s("disabled",!e.selectedProduct())("loading",e.historyLoading())}}function Oi(t,c){if(t&1){let e=b();n(0,"p-button",42),g("onClick",function(){d(e);let i=m();return u(i.openItemDialog("edit"))}),o(),n(1,"p-button",43),g("onClick",function(){d(e);let i=m();return u(i.deleteSelectedItem())}),o()}if(t&2){let e=m();s("disabled",!e.selectedProduct()),a(),s("disabled",!e.selectedProduct())}}function qi(t,c){t&1&&(n(0,"th",48),l(1," Cost "),o())}function zi(t,c){t&1&&(n(0,"th",48),l(1," Cost "),o())}function Ai(t,c){if(t&1&&(n(0,"tr")(1,"th",44),l(2,"Description"),o(),n(3,"th",45),l(4,"Category"),o(),n(5,"th",46),l(6,"Qty"),o(),_(7,qi,2,0,"th",47)(8,zi,2,0,"th",47),n(9,"th",48),l(10,"Price"),o(),n(11,"th",48),l(12,"Price"),o()()),t&2){let e=m();a(7),s("ngIf",e.userPermissions().show_cost),a(),s("ngIf",e.userPermissions().show_cost)}}function ji(t,c){if(t&1&&(n(0,"td"),l(1),k(2,"currency"),o()),t&2){let e=m().$implicit;a(),R(" ",I(2,1,e.unit_cost_usd)," ")}}function Gi(t,c){if(t&1&&(n(0,"td"),l(1),k(2,"dollar"),o()),t&2){let e=m().$implicit;a(),R(" ",I(2,1,e.unit_cost_usd)," ")}}function Qi(t,c){if(t&1&&(n(0,"tr",49)(1,"td"),l(2),o(),n(3,"td"),l(4),o(),n(5,"td"),l(6),o(),_(7,ji,3,3,"td",50)(8,Gi,3,3,"td",50),n(9,"td"),l(10),k(11,"currency"),o(),n(12,"td"),l(13),k(14,"dollar"),o()()),t&2){let e=c.$implicit,r=m();s("pSelectableRow",e),a(2),w(e.product_name),a(2),w(e.category_name||"---"),a(2),R(" ",e.stock_management?e.quantity:"--"," "),a(),s("ngIf",r.userPermissions().show_cost),a(),s("ngIf",r.userPermissions().show_cost),a(2),w(I(11,8,e.unit_price_usd)),a(3),w(I(14,10,e.unit_price_usd))}}function Wi(t,c){t&1&&(n(0,"tr")(1,"td",51),l(2,"No items yet!"),o()())}function Ui(t,c){if(t&1&&(n(0,"h3"),l(1),o()),t&2){let e=m();a(),R("",e.dialogMode," Items")}}function Zi(t,c){t&1&&(n(0,"small",52),l(1,"Name is required."),o())}function Ki(t,c){t&1&&(n(0,"div",20)(1,"label",53),l(2,"Initial Qty"),o(),f(3,"p-inputNumber",55),o())}function Yi(t,c){if(t&1&&(_(0,Ki,4,0,"div",26),n(1,"div",20)(2,"label",53),l(3,"Low Stock Threshold"),o(),f(4,"p-inputNumber",54),o()),t&2){let e=m();s("ngIf",e.dialogMode=="add")}}function Ji(t,c){t&1&&(n(0,"small",52),l(1,"Cost is required."),o())}function Xi(t,c){if(t&1&&(n(0,"div",20)(1,"label",56),l(2,"Unit Cost"),n(3,"span",17),l(4,"*"),o()(),f(5,"p-inputNumber",57),_(6,Ji,2,0,"small",19),o()),t&2){let e=m();a(5),s("ngClass",x(2,me,e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))),a(),s("ngIf",e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))}}function $i(t,c){t&1&&(n(0,"small",52),l(1,"Price is required."),o())}function en(t,c){if(t&1){let e=b();n(0,"button",58),g("click",function(){d(e);let i=m();return u(i.submitItem())}),o(),n(1,"button",59),g("click",function(){d(e);let i=m();return u(i.closeItemDialog())}),o()}if(t&2){let e=m();s("loading",e.submitItemLoading())}}function tn(t,c){if(t&1){let e=b();n(0,"form",13),g("ngSubmit",function(){d(e);let i=m();return u(i.submitStock())}),n(1,"div",14)(2,"div",60)(3,"label"),l(4,"Option"),n(5,"span",17),l(6,"*"),o()(),f(7,"p-dropdown",61),o(),n(8,"div",60)(9,"label"),l(10,"Quantity"),n(11,"span",17),l(12,"*"),o()(),f(13,"p-inputNumber",62),o(),n(14,"div",63)(15,"label"),l(16,"Notes"),o(),f(17,"input",64),o()()()}if(t&2){let e=m();s("formGroup",e.stockForm),a(7),s("autoOptionFocus",!1)("options",e.transactionOptions)("ngClass",x(6,me,(e.transaction_type==null?null:e.transaction_type.invalid)&&((e.transaction_type==null?null:e.transaction_type.dirty)||(e.transaction_type==null?null:e.transaction_type.touched)||e.submitted))),a(6),s("ngClass",x(8,me,(e.quantity==null?null:e.quantity.invalid)&&((e.quantity==null?null:e.quantity.dirty)||(e.quantity==null?null:e.quantity.touched)||e.submitted))),a(4),s("ngClass",x(10,me,(e.transaction_notes==null?null:e.transaction_notes.invalid)&&((e.transaction_notes==null?null:e.transaction_notes.dirty)||(e.transaction_notes==null?null:e.transaction_notes.touched)||e.submitted)))}}function nn(t,c){if(t&1){let e=b();n(0,"p-button",65),g("onClick",function(){d(e);let i=m();return u(i.toggleStockDialog())}),o(),n(1,"p-button",66),g("onClick",function(){d(e);let i=m();return u(i.submitStock())}),o()}}var Wt=(()=>{class t{constructor(){this.subscriptions=new _e,this.barcodeError=!1,this.stockService=C(P),this.fb=C(ae),this.confirmationService=C(oe),this.authService=C(ye),this.rowsPerPage=this.stockService.rowsPerPage,this.products=this.stockService.products,this.itemSidebarVisible=this.stockService.itemSidebarVisible,this.tableLoading=this.stockService.tableLoading,this.submitItemLoading=this.stockService.submitItemLoading,this.categories=this.stockService.categories,this.submitted=!1,this.selectedProduct=this.stockService.selectedProduct,this.userPermissions=this.authService.userPermissions,this.itemForm=this.fb.group({product_id:[null],category_id_fk:[{value:null,disabled:!1}],product_name:[null,T.required],barcode:[null],unit_cost_usd:[null,T.required],unit_price_usd:[null,T.required],quantity:[null],product_notes:[null],low_stock_threshold:[null],stock_management:[!1]}),this.stockDialogVisible=this.stockService.stockDialogVisible,this.transactionOptions=[{name:"Add",value:"ADD"},{name:"Remove",value:"REMOVE"}],this.stockForm=this.fb.group({product_id_fk:[null],transaction_type:[{value:null,disabled:!1},T.required],quantity:[null,T.required],transaction_notes:[null,T.required]}),this.historyDialogVisible=this.stockService.historyDialogVisible,this.historyLoading=this.stockService.historyLoading,this.generatedBarcode=null}onKeyDown(e){!this.itemSidebarVisible()&&!this.stockDialogVisible()&&this.tableSearch.nativeElement.focus()}ngOnInit(){this.subscriptions.add(this.stockService.barcodeError.subscribe(()=>{this.barcodeError=!0})),this.subscriptions.add(this.stockService.itemCreated.subscribe(()=>{this.resetDialog()})),this.subscriptions.add(this.stockService.generatedBarcode.subscribe(e=>{e&&this.itemForm.patchValue({barcode:e})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}updateRowsPerPage(e){this.stockService.updateRowsPerPage(e)}get category_id_fk(){return this.itemForm.get("category_id_fk")}get product_name(){return this.itemForm.get("product_name")}get unit_cost_usd(){return this.itemForm.get("unit_cost_usd")}get unit_price_usd(){return this.itemForm.get("unit_price_usd")}get stock_management(){return this.itemForm.get("stock_management")}clearBarcode(){this.itemForm.patchValue({barcode:null})}openItemDialog(e){this.dialogMode=e,this.dialogMode=="add"?this.stockService.itemSidebarVisible.set(!0):this.dialogMode=="edit"&&(this.selectedProduct().stock_management=this.selectedProduct().stock_management==1,this.itemForm.patchValue(this.selectedProduct()),this.stockService.itemSidebarVisible.set(!0))}closeItemDialog(){this.stockService.itemSidebarVisible.set(!1)}resetDialog(){this.submitted=!1,this.itemForm.reset({stock_management:!1})}submitItem(){this.submitted=!0,this.clearBarcodeError(),this.dialogMode=="add"?this.itemForm.valid&&(this.itemForm.controls.barcode.value==""&&this.itemForm.patchValue({barcode:null}),this.stockService.createItem(this.itemForm.value),this.submitted=!1):this.itemForm.valid&&this.stockService.updateItem(this.itemForm.value)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:"Are you sure you want to delete selected item?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedProduct())}})}refreshTable(){this.stockService.getItems()}clearBarcodeError(){this.barcodeError=!1}get transaction_type(){return this.stockForm.get("transaction_type")}get quantity(){return this.stockForm.get("quantity")}get transaction_notes(){return this.stockForm.get("transaction_notes")}openStockDialog(){this.stockService.stockDialogVisible.set(!0)}toggleStockDialog(){this.stockService.stockDialogVisible.set(!1)}submitStock(){this.submitted=!0,this.stockForm.valid&&(this.stockForm.patchValue({product_id_fk:this.selectedProduct()?.product_id}),this.stockService.submitStock(this.stockForm.value))}resetStockDialog(){this.submitted=!1,this.stockForm.reset(),this.stockService.stockDialogVisible.set(!1)}fetchHistory(){this.stockService.fetchStockHistory(this.selectedProduct().product_id)}closeHistoryDialog(){this.stockService.historyDialogVisible.set(!1)}generateBarcode(){this.clearBarcodeError(),this.stockService.generateBarcode()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["app-inventory"]],viewQuery:function(r,i){if(r&1&&(X(Pi,5),X(Ri,5)),r&2){let p;L(p=B())&&(i.tableSearch=p.first),L(p=B())&&(i.itemName=p.first)}},hostBindings:function(r,i){r&1&&g("keydown",function(h){return i.onKeyDown(h)},!1,Ye)},decls:55,vars:37,consts:[["dt2",""],["itemName",""],["tableSearch",""],[1,"grid","m-1"],[1,"col-12"],["pTemplate","left"],["pTemplate","center"],["pTemplate","right"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","65vh",3,"selectionChange","rowsChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","right","styleClass","w-30rem",3,"visibleChange","onHide","visible"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12"],["for","name"],[1,"text-red-600"],["placeholder","Product Name","id","name","pInputText","","formControlName","product_name","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngClass"],["class","p-error",4,"ngIf"],[1,"field","col-6"],["for","Category"],["styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","formControlName","category_id_fk","optionLabel","category_name","optionValue","category_id","placeholder","Select Category ...","filterBy","category_name",3,"autoOptionFocus","showClear","options","filter"],[1,"flex","align-items-center","gap-1"],["formControlName","stock_management","inputId","stock_management",3,"binary"],["for","stock_management"],["class","field col-6",4,"ngIf"],["for","unit_price_usd"],["styleClass","w-full","formControlName","unit_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["for","product_notes"],["type","text","pInputText","","formControlName","product_notes","spellcheck","false",1,"w-full"],["pTemplate","footer"],["header","Stock Correction","styleClass","p-fluid","position","top",3,"onHide","visible","modal"],["pTemplate","content"],[3,"onClose","visible","product_id"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","mx-2 ",3,"onClick","loading"],["label","New","icon","pi pi-plus","severity","success","size","small",3,"onClick"],["label","Correct Stock","size","small","severity","info","icon","pi pi-wrench",3,"onClick","disabled"],["label","History","size","small","severity","contrast","icon","pi pi-history","styleClass","ml-2",3,"onClick","disabled","loading"],["pp-button","","pRipple","","label","Edit","icon","pi pi-file-edit","size","small","severity","warning",3,"onClick","disabled"],["pp-button","","pRipple","","label","Delete","icon","pi pi-trash","size","small","severity","danger",1,"ml-2",3,"onClick","disabled"],["width","40%"],["width","15%"],["width","5%"],["width","10%",4,"ngIf"],["width","10%"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","8"],[1,"p-error"],["for","qty"],["styleClass","w-full","formControlName","low_stock_threshold","placeholder","low stock qty",1,"p-inputtext-sm","w-full"],["styleClass","w-full","formControlName","quantity","placeholder","Initial Qty",1,"p-inputtext-sm","w-full"],["for","unit_cost_usd"],["styleClass","w-full","formControlName","unit_cost_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["type","submit","pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success","w-full","mb-3",3,"click","loading"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary","w-full",3,"click"],[1,"field","col-12","md:col-3"],["scrollHeight","400px","appendTo","body","formControlName","transaction_type","optionLabel","name","optionValue","value","placeholder","transaction type ...",3,"autoOptionFocus","options","ngClass"],["formControlName","quantity",3,"ngClass"],[1,"field","col-12","md:col-6"],["type","text","spellcheck","false","pInputText","","formControlName","transaction_notes",1,"w-full",3,"ngClass"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Save","icon","pi pi-check","severity","success","size","small",3,"onClick"]],template:function(r,i){if(r&1){let p=b();n(0,"div",3)(1,"div",4)(2,"p-card")(3,"p-toolbar"),_(4,Bi,6,2,"ng-template",5)(5,Hi,2,3,"ng-template",6)(6,Oi,2,2,"ng-template",7),o(),n(7,"p-table",8,0),D("selectionChange",function(y){return d(p),V(i.selectedProduct,y)||(i.selectedProduct=y),u(y)}),g("rowsChange",function(y){return d(p),u(i.updateRowsPerPage(y))}),_(9,Ai,13,2,"ng-template",9)(10,Qi,15,12,"ng-template",10)(11,Wi,3,0,"ng-template",11),o()()()(),n(12,"p-sidebar",12),D("visibleChange",function(y){return d(p),V(i.itemSidebarVisible,y)||(i.itemSidebarVisible=y),u(y)}),g("onHide",function(){return d(p),u(i.resetDialog())}),_(13,Ui,2,1,"ng-template",9),n(14,"form",13),g("ngSubmit",function(){return d(p),u(i.submitItem())}),n(15,"div",14)(16,"div",15)(17,"label",16),l(18,"Product Name"),n(19,"span",17),l(20,"*"),o()(),f(21,"input",18,1),_(23,Zi,2,0,"small",19),o(),n(24,"div",20)(25,"label",21),l(26,"Category"),o(),f(27,"p-dropdown",22),o(),n(28,"div",20)(29,"label"),l(30,"Stock Management"),o(),f(31,"br"),n(32,"div",23),f(33,"p-checkbox",24),n(34,"label",25),l(35,"Enable"),o()()(),_(36,Yi,5,1),o(),n(37,"div",14),_(38,Xi,7,4,"div",26),n(39,"div",20)(40,"label",27),l(41,"Unit price"),n(42,"span",17),l(43,"*"),o()(),f(44,"p-inputNumber",28),_(45,$i,2,0,"small",19),o(),n(46,"div",15)(47,"label",29),l(48,"Notes"),o(),f(49,"input",30),o()()(),_(50,en,2,1,"ng-template",31),o(),n(51,"p-dialog",32),g("onHide",function(){return d(p),u(i.resetStockDialog())}),_(52,tn,18,12,"ng-template",33)(53,nn,2,0,"ng-template",31),o(),n(54,"stock-transactions",34),g("onClose",function(){return d(p),u(i.closeHistoryDialog())}),o()}if(r&2){let p;a(7),s("value",i.products()),E("selection",i.selectedProduct),s("paginator",!0)("rows",i.rowsPerPage())("showCurrentPageReport",!0)("rowsPerPageOptions",v(30,Ni))("alwaysShowPaginator",!0)("globalFilterFields",v(31,Mi))("filterDelay",0)("loading",i.tableLoading())("scrollable",!0),a(5),E("visible",i.itemSidebarVisible),a(2),s("formGroup",i.itemForm),a(7),s("ngClass",x(32,me,i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted))),a(2),s("ngIf",i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted)),a(4),s("autoOptionFocus",!1)("showClear",!0)("options",i.categories())("filter",!0),a(6),s("binary",!0),a(3),ge(i.stock_management.value?36:-1),a(2),s("ngIf",i.userPermissions().show_cost),a(6),s("ngClass",x(34,me,i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted))),a(),s("ngIf",i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted)),a(6),O(v(36,Li)),s("visible",i.stockDialogVisible())("modal",!0),a(3),s("visible",i.historyDialogVisible())("product_id",(p=i.selectedProduct())==null?null:p.product_id)}},dependencies:[z,N,G,re,A,j,Q,W,K,F,Y,J,ve,U,Z,ke,le,ce,vt,Fe,Re,Ee,he,Te],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}[_nghost-%COMP%]  .p-toolbar{padding-top:.6rem!important;padding-bottom:.6rem!important}"]})}}return t})();var Ut=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["app-stock-home"]],decls:1,vars:0,template:function(r,i){r&1&&f(0,"router-outlet")},dependencies:[_t]})}}return t})();var on=["rateInput"],rn=()=>({width:"35vw"}),an=()=>({"1199px":"85vw","575px":"95vw"});function sn(t,c){if(t&1){let e=b();n(0,"form",8),g("ngSubmit",function(){d(e);let i=m();return u(i.submit())}),n(1,"div",9)(2,"label",10),l(3,"Exchange Rate"),o(),f(4,"p-inputNumber",11,0),o()()}if(t&2){let e=m();s("formGroup",e.rateForm),a(4),s("min",1e3)}}function ln(t,c){if(t&1){let e=b();n(0,"p-button",12),g("onClick",function(){d(e);let i=m();return u(i.toggleDialog(!1))}),o(),n(1,"p-button",13),g("onClick",function(){d(e);let i=m();return u(i.submit())}),o()}}var Zt=(()=>{class t{constructor(){this.stockService=C(P),this.formBuilder=C(ae),this.exchangeRate=this.stockService.exchangeRate,this.rateDialogVisible=this.stockService.rateDialogVisible,this.dialogVisible=!1,ct(()=>{this.rateForm=this.formBuilder.group({rate_value:[this.exchangeRate().rate_value]})})}toggleDialog(e){this.stockService.rateDialogVisible.set(e),setTimeout(()=>{this.rateInput&&this.rateInput.input.nativeElement.select()},50)}submit(){this.rateForm.valid&&this.stockService.updateExchangeRate(this.rateForm.value)}resetDialog(){this.rateForm.reset({rate_value:this.exchangeRate().rate_value}),this.stockService.rateDialogVisible.set(!1)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["exchange-rate"]],viewQuery:function(r,i){if(r&1&&X(on,5),r&2){let p;L(p=B())&&(i.rateInput=p.first)}},decls:12,vars:10,consts:[["rateInput",""],[1,"p-toolbar-group-start"],[1,"text-green-600"],[1,"p-toolbar-group-end"],["icon","pi pi-file-edit","styleClass","p-button-warning","label","Edit",3,"onClick"],["header","Exchange Rate","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["formControlName","rate_value",3,"min"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Save","icon","pi pi-check","severity","success","size","small",3,"onClick"]],template:function(r,i){r&1&&(n(0,"p-toolbar")(1,"div",1)(2,"h3"),l(3," Dollar Exchange: "),n(4,"i",2),l(5),k(6,"lira"),o()()(),n(7,"div",3)(8,"p-button",4),g("onClick",function(){return i.toggleDialog(!0)}),o()()(),n(9,"p-dialog",5),D("visibleChange",function(h){return V(i.rateDialogVisible,h)||(i.rateDialogVisible=h),h}),g("onHide",function(){return i.resetDialog()}),_(10,sn,6,2,"ng-template",6)(11,ln,2,0,"ng-template",7),o()),r&2&&(a(5),w(I(6,6,i.exchangeRate().rate_value)),a(4),O(v(8,rn)),E("visible",i.rateDialogVisible),s("modal",!0)("breakpoints",v(9,an)))},dependencies:[G,A,j,Q,W,F,J,U,Z,ce,Rt]})}}return t})();var Kt=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["stock-settings"]],decls:5,vars:0,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1),f(2,"exchange-rate"),o(),n(3,"div",1),f(4,"stock-value"),o()())},dependencies:[Ve,Zt]})}}return t})();var pn=()=>[10,15,50,100],dn=()=>["category_name"],un=()=>({width:"35vw"}),_n=()=>({"1199px":"75vw","575px":"85vw"}),gn=(t,c)=>({" pi-check-circle text-green-600":t,"pi-times-circle text-red-600":c}),fn=t=>({"ng-invalid ng-dirty":t});function hn(t,c){if(t&1){let e=b();n(0,"span",13),f(1,"i",14),n(2,"input",15,1),g("input",function(i){d(e),m();let p=q(5);return u(p.filterGlobal(i.target.value,"contains"))}),o()(),n(4,"p-button",16),g("onClick",function(){d(e);let i=m();return u(i.refreshCategories())}),o(),n(5,"p-button",17),g("onClick",function(){d(e);let i=m();return u(i.openCategoryDialog("add"))}),o()}if(t&2){let e=m(),r=q(5);a(2),s("value",r.filters.global==null?null:r.filters.global.value),a(2),s("loading",e.categoriesLoading())}}function bn(t,c){if(t&1){let e=b();n(0,"p-button",18),g("onClick",function(){d(e);let i=m();return u(i.openCategoryDialog("edit"))}),o(),n(1,"p-button",19),g("onClick",function(){d(e);let i=m();return u(i.deleteSelectedCategory())}),o()}if(t&2){let e=m();s("disabled",!e.selectedCategory()),a(),s("disabled",!e.selectedCategory())}}function yn(t,c){t&1&&(n(0,"tr")(1,"th",20),l(2,"Sort"),o(),n(3,"th",21),l(4,"Name"),o(),n(5,"th",22),l(6,"Visible?"),o()())}function Cn(t,c){if(t&1&&(n(0,"tr",23)(1,"td"),f(2,"span",24),o(),n(3,"td"),l(4),o(),n(5,"td"),f(6,"i",25),o()()),t&2){let e=c.$implicit,r=c.rowIndex;s("pReorderableRow",r)("pSelectableRow",e),a(4),w(e.category_name),a(2),s("ngClass",fe(4,gn,e.show_on_sell,!e.show_on_sell))}}function vn(t,c){t&1&&(n(0,"tr")(1,"td",26),l(2,"No Categories yet!"),o()())}function Sn(t,c){t&1&&(n(0,"small",35),l(1,"Name is required."),o())}function wn(t,c){if(t&1){let e=b();n(0,"form",27),g("ngSubmit",function(){d(e);let i=m();return u(i.submitCategory())}),n(1,"div",28)(2,"label",29),l(3,"Category Name"),o(),f(4,"input",30),_(5,Sn,2,0,"small",31),o(),n(6,"div",32),f(7,"p-inputSwitch",33),n(8,"label",34),l(9,"Show on sell page?"),o()()()}if(t&2){let e=m();s("formGroup",e.categoryForm),a(4),s("ngClass",x(3,fn,(e.category_name==null?null:e.category_name.invalid)&&((e.category_name==null?null:e.category_name.dirty)||(e.category_name==null?null:e.category_name.touched)))),a(),s("ngIf",(e.category_name==null?null:e.category_name.invalid)&&((e.category_name==null?null:e.category_name.dirty)||(e.category_name==null?null:e.category_name.touched)))}}function xn(t,c){if(t&1){let e=b();n(0,"p-button",36),g("onClick",function(){d(e);let i=m();return u(i.categoryDialogVisible.set(!1))}),o(),n(1,"p-button",37),g("click",function(){d(e);let i=m();return u(i.submitCategory())}),o()}}var Yt=(()=>{class t{constructor(){this.stockService=C(P),this.confirmationService=C(oe),this.notificationService=C(ft),this.categoryDialogVisible=this.stockService.categoryDialogVisible,this.categories=this.stockService.categories,this.categoriesLoading=this.stockService.categoriesLoading,this.selectedCategory=this.stockService.selectedCategory,this.categoryForm=new ht({category_id:new Ce,category_name:new Ce(null,T.required),show_on_sell:new Ce(!0)})}sortCategories(){this.stockService.sortCategories()}selectCategory(){this.stockService.getFilteredItems(this.selectedCategory(),"stock")}refreshCategories(){this.stockService.getCategories()}get category_name(){return this.categoryForm.get("category_name")}openCategoryDialog(e){this.dialogMode=e,this.dialogMode=="add"?this.stockService.categoryDialogVisible.set(!0):(this.categoryForm.patchValue({category_id:this.selectedCategory()?.category_id,category_name:this.selectedCategory()?.category_name,show_on_sell:this.selectedCategory()?.show_on_sell==1}),this.stockService.categoryDialogVisible.set(!0))}submitCategory(){this.dialogMode=="add"?this.categoryForm.valid&&(this.stockService.createCategory(this.categoryForm.value),this.stockService.categoryDialogVisible.set(!1)):this.dialogMode=="edit"&&this.categoryForm.valid&&(this.stockService.updateCategory(this.categoryForm.value),this.stockService.selectedCategory.set(null))}deleteSelectedCategory(){this.stockService.filteredItems().length!=0?this.notificationService.showError("Delete all category items before proceeding!","home"):this.confirmationService.confirm({key:"home",message:`Are you sure that you want to delete "${this.selectedCategory()?.category_name}"?`,header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteCategory(this.selectedCategory().category_id)}})}resetDialog(){this.categoryForm.reset({category_name:null,show_on_sell:!0})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["categories"]],decls:12,vars:20,consts:[["ct",""],["tableSearch",""],["header","Categories"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["selectionMode","single","dataKey","category_id","styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","55vh",3,"selectionChange","onRowReorder","onRowSelect","value","selection","loading","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","scrollable","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Category","styleClass","p-fluid",3,"onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","mx-2",3,"onClick","loading"],["label","New Category","icon","pi pi-plus","severity","success","size","small",3,"onClick"],["label","Edit","icon","pi pi-file-edit","severity","warning","size","small",1,"mr-2",3,"onClick","disabled"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",3,"onClick","disabled"],["width","10%"],["width","75%"],["width","15%"],[3,"pReorderableRow","pSelectableRow"],["pReorderableRowHandle","",1,"pi","pi-bars"],[1,"pi",3,"ngClass"],["colspan","3"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["type","text","pInputText","","formControlName","category_name","required","","autofocus","","spellcheck","false",3,"ngClass"],["class","p-error",4,"ngIf"],[1,"flex","align-items-center","justify-content-center","gap-2"],["id","showOnSell","formControlName","show_on_sell"],["for","showOnSell"],[1,"p-error"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Save","icon","pi pi-check","severity","success","size","small",3,"click"]],template:function(r,i){if(r&1){let p=b();n(0,"p-panel",2)(1,"p-toolbar",3),_(2,hn,6,2,"ng-template",4)(3,bn,2,2,"ng-template",5),o(),n(4,"p-table",6,0),D("selectionChange",function(y){return d(p),V(i.selectedCategory,y)||(i.selectedCategory=y),u(y)}),g("onRowReorder",function(){return d(p),u(i.sortCategories())})("onRowSelect",function(){return d(p),u(i.selectCategory())}),_(6,yn,7,0,"ng-template",7)(7,Cn,7,7,"ng-template",8)(8,vn,3,0,"ng-template",9),o()(),n(9,"p-dialog",10),g("onHide",function(){return d(p),u(i.resetDialog())}),_(10,wn,10,5,"ng-template",11)(11,xn,2,0,"ng-template",12),o()}r&2&&(a(4),s("value",i.categories()),E("selection",i.selectedCategory),s("loading",i.categoriesLoading())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",v(16,pn))("alwaysShowPaginator",!0)("scrollable",!0)("globalFilterFields",v(17,dn))("filterDelay",0),a(5),O(v(18,un)),s("visible",i.categoryDialogVisible())("modal",!0)("breakpoints",v(19,_n)))},dependencies:[z,N,G,re,A,j,bt,Q,W,K,F,Y,Dt,Ft,J,U,Z,le,we,Ht]})}}return t})();var In=["itemName"],Tn=()=>[10,25,50],Ze=t=>({"ng-invalid ng-dirty":t});function En(t,c){if(t&1){let e=b();n(0,"button",30),g("click",function(){d(e);let i=m();return u(i.openItemDialog("add"))}),o()}}function Vn(t,c){if(t&1){let e=b();n(0,"button",31),g("click",function(){d(e);let i=m();return u(i.openItemDialog("edit"))}),o(),n(1,"button",32),g("click",function(){d(e);let i=m();return u(i.deleteSelectedItem())}),o()}if(t&2){let e=m();s("disabled",!e.selectedItem),a(),s("disabled",!e.selectedItem)}}function Dn(t,c){t&1&&(n(0,"th",36),l(1,"Cost"),o())}function Fn(t,c){t&1&&(n(0,"th",36),l(1," Cost LBP "),o())}function Pn(t,c){if(t&1&&(n(0,"tr")(1,"th",33),l(2,"Name"),o(),n(3,"th",34),l(4,"Qty"),o(),_(5,Dn,2,0,"th",35)(6,Fn,2,0,"th",35),n(7,"th",36),l(8,"Price"),o(),n(9,"th",36),l(10,"Price LBP"),o()()),t&2){let e=m();a(5),s("ngIf",e.userPermissions().show_cost),a(),s("ngIf",e.userPermissions().show_cost)}}function Rn(t,c){if(t&1&&(n(0,"td"),l(1),k(2,"currency"),o()),t&2){let e=m().$implicit;a(),R(" ",I(2,1,e.unit_cost_usd)," ")}}function Nn(t,c){if(t&1&&(n(0,"td"),l(1),k(2,"dollar"),o()),t&2){let e=m().$implicit;a(),R(" ",I(2,1,e.unit_cost_usd)," ")}}function Mn(t,c){if(t&1&&(n(0,"tr",37)(1,"td"),l(2),o(),n(3,"td"),l(4),o(),_(5,Rn,3,3,"td",38)(6,Nn,3,3,"td",38),n(7,"td"),l(8),k(9,"currency"),o(),n(10,"td"),l(11),k(12,"dollar"),o()()),t&2){let e=c.$implicit,r=m();s("pSelectableRow",e),a(2),w(e.product_name),a(2),R(" ",e.stock_management?e.quantity:"--"," "),a(),s("ngIf",r.userPermissions().show_cost),a(),s("ngIf",r.userPermissions().show_cost),a(2),w(I(9,7,e.unit_price_usd)),a(3),w(I(12,9,e.unit_price_usd))}}function Ln(t,c){t&1&&(n(0,"tr")(1,"td",39),l(2,"No items yet!"),o()())}function Bn(t,c){if(t&1&&(n(0,"h3"),l(1),o()),t&2){let e=m();a(),R("",e.dialogMode," Items")}}function Hn(t,c){t&1&&(n(0,"small",40),l(1,"Name is required."),o())}function On(t,c){t&1&&(n(0,"div",18)(1,"label",41),l(2,"Initial Qty"),o(),f(3,"p-inputNumber",43),o())}function qn(t,c){if(t&1&&(_(0,On,4,0,"div",24),n(1,"div",18)(2,"label",41),l(3,"Low Stock Threshold"),o(),f(4,"p-inputNumber",42),o()),t&2){let e=m();s("ngIf",e.dialogMode=="add")}}function zn(t,c){t&1&&(n(0,"small",40),l(1,"Cost is required."),o())}function An(t,c){if(t&1&&(n(0,"div",18)(1,"label",44),l(2,"Unit Cost"),n(3,"span",15),l(4,"*"),o()(),f(5,"p-inputNumber",45),_(6,zn,2,0,"small",17),o()),t&2){let e=m();a(5),s("ngClass",x(2,Ze,e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))),a(),s("ngIf",e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))}}function jn(t,c){t&1&&(n(0,"small",40),l(1,"Price is required."),o())}function Gn(t,c){if(t&1){let e=b();n(0,"button",46),g("click",function(){d(e);let i=m();return u(i.submitItem())}),o(),n(1,"button",47),g("click",function(){d(e);let i=m();return u(i.closeItemDialog())}),o()}if(t&2){let e=m();s("loading",e.submitItemLoading())}}var Jt=(()=>{class t{constructor(){this.stockService=C(P),this.authService=C(ye),this.fb=C(ae),this.confirmationService=C(oe),this.userPermissions=this.authService.userPermissions,this.selectedCategory=this.stockService.selectedCategory,this.filteredItems=this.stockService.filteredItems,this.categories=this.stockService.categories,this.submitted=!1,this.itemSidebarVisible=this.stockService.itemSidebarVisible,this.tableLoading=this.stockService.tableLoading,this.submitItemLoading=this.stockService.submitItemLoading,this.subscriptions=new _e,this.barcodeError=!1,this.itemForm=this.fb.group({product_id:[null],category_id_fk:[{value:null,disabled:!1}],product_name:[null,T.required],barcode:[null],unit_cost_usd:[null,T.required],unit_price_usd:[null,T.required],quantity:[null],product_notes:[null],low_stock_threshold:[null],stock_management:[!1]}),this.generatedBarcode=null}ngOnInit(){this.subscriptions.add(this.stockService.barcodeError.subscribe(()=>{this.barcodeError=!0})),this.subscriptions.add(this.stockService.itemCreated.subscribe(()=>{this.resetDialog()})),this.subscriptions.add(this.stockService.generatedBarcode.subscribe(e=>{e&&this.itemForm.patchValue({barcode:e})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get category_id_fk(){return this.itemForm.get("category_id_fk")}get product_name(){return this.itemForm.get("product_name")}get unit_cost_usd(){return this.itemForm.get("unit_cost_usd")}get unit_price_usd(){return this.itemForm.get("unit_price_usd")}get stock_management(){return this.itemForm.get("stock_management")}openItemDialog(e){this.dialogMode=e,this.dialogMode=="add"?(this.itemForm.patchValue({category_id_fk:this.selectedCategory().category_id}),this.stockService.itemSidebarVisible.set(!0)):this.dialogMode=="edit"&&(this.selectedItem.stock_management=this.selectedItem.stock_management==1,this.itemForm.patchValue(this.selectedItem),this.stockService.itemSidebarVisible.set(!0))}submitItem(){this.submitted=!0,this.dialogMode=="add"?this.itemForm.valid&&(this.itemForm.controls.barcode.value==""&&this.itemForm.patchValue({barcode:null}),this.stockService.createItem(this.itemForm.value),this.submitted=!1,this.focusInput()):this.itemForm.valid&&(this.stockService.updateItem(this.itemForm.value),this.selectedItem=null)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:"Are you sure you want to delete selected item?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedItem),this.selectedItem=null}})}refreshTable(){this.stockService.getItems()}focusInput(){}clearBarcode(){this.itemForm.patchValue({barcode:null})}clearBarcodeError(){this.barcodeError=!1}resetDialog(){this.submitted=!1,this.itemForm.reset({stock_management:!1,category_id_fk:this.selectedCategory()?.category_id})}closeItemDialog(){this.stockService.itemSidebarVisible.set(!1)}generateBarcode(){this.stockService.generateBarcode()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["category-items"]],viewQuery:function(r,i){if(r&1&&X(In,5),r&2){let p;L(p=B())&&(i.itemName=p.first)}},decls:49,vars:28,consts:[["dt",""],["itemName",""],[3,"header"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","right","styleClass","w-30rem",3,"visibleChange","onShow","onHide","visible"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-12"],["for","name"],[1,"text-red-600"],["placeholder","Product Name","id","name","pInputText","","formControlName","product_name","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngClass"],["class","p-error",4,"ngIf"],[1,"field","col-6"],["for","Category"],["styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","formControlName","category_id_fk","optionLabel","category_name","optionValue","category_id","placeholder","Select Category ...","filterBy","category_name",3,"autoOptionFocus","showClear","options","filter"],[1,"flex","align-items-center","gap-1"],["formControlName","stock_management","inputId","stock_management",3,"binary"],["for","stock_management"],["class","field col-6",4,"ngIf"],["for","unit_price_usd"],["styleClass","w-full","formControlName","unit_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["for","product_notes"],["type","text","pInputText","","formControlName","product_notes","spellcheck","false",1,"w-full"],["pTemplate","footer"],["pButton","","pRipple","","label","New Item","icon","pi pi-plus",1,"p-button-success","mr-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","Edit","icon","pi pi-file-edit",1,"p-button-warning","p-button-sm","mr-2",3,"click","disabled"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger","p-button-sm",3,"click","disabled"],["width","35%"],["width","5%"],["width","15%",4,"ngIf"],["width","15%"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","5"],[1,"p-error"],["for","qty"],["styleClass","w-full","formControlName","low_stock_threshold","placeholder","low stock qty",1,"p-inputtext-sm","w-full"],["styleClass","w-full","formControlName","quantity","placeholder","Initial Qty",1,"p-inputtext-sm","w-full"],["for","unit_cost_usd"],["styleClass","w-full","formControlName","unit_cost_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["type","submit","pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success","w-full","mb-3",3,"click","loading"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary","w-full",3,"click"]],template:function(r,i){if(r&1){let p=b();n(0,"p-panel",2),k(1,"titlecase"),n(2,"p-toolbar",3),_(3,En,1,0,"ng-template",4)(4,Vn,2,2,"ng-template",5),o(),n(5,"p-table",6,0),D("selectionChange",function(y){return d(p),V(i.selectedItem,y)||(i.selectedItem=y),u(y)}),_(7,Pn,11,2,"ng-template",7)(8,Mn,13,11,"ng-template",8)(9,Ln,3,0,"ng-template",9),o()(),n(10,"p-sidebar",10),D("visibleChange",function(y){return d(p),V(i.itemSidebarVisible,y)||(i.itemSidebarVisible=y),u(y)}),g("onShow",function(){return d(p),u(i.focusInput())})("onHide",function(){return d(p),u(i.resetDialog())}),_(11,Bn,2,1,"ng-template",7),n(12,"form",11),g("ngSubmit",function(){return d(p),u(i.submitItem())}),n(13,"div",12)(14,"div",13)(15,"label",14),l(16,"Product Name"),n(17,"span",15),l(18,"*"),o()(),f(19,"input",16,1),_(21,Hn,2,0,"small",17),o(),n(22,"div",18)(23,"label",19),l(24,"Category"),o(),f(25,"p-dropdown",20),o(),n(26,"div",18)(27,"label"),l(28,"Stock Management"),o(),f(29,"br"),n(30,"div",21),f(31,"p-checkbox",22),n(32,"label",23),l(33,"Enable"),o()()(),_(34,qn,5,1),o(),n(35,"div",12),_(36,An,7,4,"div",24),n(37,"div",18)(38,"label",25),l(39,"Unit price"),n(40,"span",15),l(41,"*"),o()(),f(42,"p-inputNumber",26),_(43,jn,2,0,"small",17),o(),n(44,"div",13)(45,"label",27),l(46,"Notes"),o(),f(47,"input",28),o()()(),_(48,Gn,2,1,"ng-template",29),o()}r&2&&(it("header",I(1,21,i.selectedCategory().category_name)),a(5),s("value",i.filteredItems()),E("selection",i.selectedItem),s("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",v(23,Tn))("alwaysShowPaginator",!1),a(5),E("visible",i.itemSidebarVisible),a(2),s("formGroup",i.itemForm),a(7),s("ngClass",x(24,Ze,i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted))),a(2),s("ngIf",i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted)),a(4),s("autoOptionFocus",!1)("showClear",!0)("options",i.categories())("filter",!0),a(6),s("binary",!0),a(3),ge(i.stock_management.value?34:-1),a(2),s("ngIf",i.userPermissions().show_cost),a(6),s("ngClass",x(26,Ze,i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted))),a(),s("ngIf",i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted)))},dependencies:[z,N,G,re,A,j,Q,W,K,F,Y,J,ve,ke,le,ce,Fe,we,Ee,ut,he,Te]})}}return t})();function Wn(t,c){t&1&&f(0,"category-items")}var Xt=(()=>{class t{constructor(){this.stockService=C(P),this.selectedCategory=this.stockService.selectedCategory}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=S({type:t,selectors:[["app-categories-home"]],decls:5,vars:1,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"],[4,"ngIf"]],template:function(r,i){r&1&&(n(0,"div",0)(1,"div",1),f(2,"categories"),o(),n(3,"div",1),_(4,Wn,1,0,"category-items",2),o()()),r&2&&(a(4),s("ngIf",i.selectedCategory()))},dependencies:[N,Yt,Jt]})}}return t})();var Un=[{path:"",component:Ut,children:[{path:"categories",data:{breadcrumb:"Categories"},component:Xt},{path:"items",data:{breadcrumb:"Inventory"},component:Wt},{path:"settings",data:{breadcrumb:"Settings"},component:Kt},{path:"**",redirectTo:"/stock/categories"}]}],$t=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=te({type:t})}static{this.\u0275inj=ee({imports:[Le.forChild(Un),Le]})}}return t})();var ta=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=te({type:t})}static{this.\u0275inj=ee({imports:[be,yt,Ct,$t,Ie,Pt,Se,xe,Et,kt,Vt,St,Nt,At,Tt,Ot,qt,zt,Re,Mt,Ve]})}}return t})();export{ta as StockModule};
