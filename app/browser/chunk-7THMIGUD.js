import{a as l}from"./chunk-LQTJ6KB6.js";import{b as h}from"./chunk-ZZBHPNZI.js";import{Kb as r,Lb as n,U as a,eb as c,o,s as i}from"./chunk-4RWQR7BF.js";var v=(()=>{class s{constructor(){this.http=i(c),this.api=i(n),this.notificationService=i(r),this.socket=i(l),this.userService=i(h),this.loading_balance=a(!1),this.balance=a({}),this.cashDialogVisible=a(!1),this.socketId=this.userService.socketId,this.getBalance(),this.initializeSockets()}getBalance(){this.loading_balance.set(!0),this.http.get(`${this.api.host()}/balance`).subscribe({next:t=>{this.balance.set(t),this.loading_balance.set(!1)},error:t=>{console.log(t),this.loading_balance.set(!1)}})}submitCash(t){this.http.post(`${this.api.host()}/balance/correct`,t).subscribe({next:e=>{this.notificationService.showSuccess(e.message,"home"),this.cashDialogVisible.set(!1),this.getBalance()},error:e=>{this.notificationService.handleError(e.error,"home")}})}initializeSockets(){this.socket.on("cashBalanceUpdated",t=>{t.user_id!=this.socketId()&&(this.getBalance(),this.notificationService.showSocketMessage("Cash balance have been updated manually!","home"))})}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275prov=o({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{v as a};
