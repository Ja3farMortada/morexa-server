import{a as qt,b as Gt,c as At,d as Qt}from"./chunk-5YHL6BPB.js";import{a as De}from"./chunk-25AQWVWA.js";import{a as Te,b as Lt}from"./chunk-F4ACXDGC.js";import{a as we,b as Vt}from"./chunk-LVW5SVAS.js";import{a as Ee,b as Ht,c as Ve,d as Ot}from"./chunk-SFXIGZYP.js";import{a as Mt}from"./chunk-WBSRFJMU.js";import{a as X,b as Nt}from"./chunk-4GPBFMHM.js";import{a as Ce}from"./chunk-4546A6RN.js";import{b as D}from"./chunk-WXO343II.js";import"./chunk-IIKNGJ5Q.js";import{b as pe,c as Ft,f as Y,i as J,o as Pt,p as Rt,q as Ie}from"./chunk-V5S3SSVI.js";import{b as Bt}from"./chunk-YMJQKFAR.js";import"./chunk-YALSPSUR.js";import"./chunk-HG4IGECD.js";import"./chunk-KLFVQY4H.js";import{a as wt,b as xt}from"./chunk-SS6FJAUF.js";import{i as ke,j as Dt}from"./chunk-DHXFVDEA.js";import{$ as et,$a as _t,$b as se,A as u,Aa as T,Ba as E,Da as at,E as ne,Ea as S,Eb as ht,Ec as ze,Fa as x,Fc as K,Ga as he,Gc as xe,H as Ye,Hb as V,Ib as Oe,Ka as st,Kb as bt,M as Je,N as a,Na as R,Nb as ae,O as oe,Oa as N,Pa as lt,Pb as k,R as Xe,Ra as ct,Rb as j,Sa as $,Sb as z,Ta as mt,Tb as yt,Va as pt,Vb as ve,W as $e,Wa as dt,X as _,Xa as Q,Xb as W,Y as O,Yb as U,Z as s,Za as M,Zb as Z,_a as ut,_b as Ct,a as ge,aa as q,ab as gt,ac as vt,ba as tt,bb as be,bc as St,ca as fe,cb as ye,cc as le,da as o,ea as n,fa as f,ga as Be,ha as Le,ia as de,ic as kt,ja as b,jc as It,ka as g,kc as ce,la as m,lc as B,ma as it,mb as ft,mc as Se,na as nt,nc as me,oa as ot,oc as Tt,p as te,qa as rt,ra as H,rc as Et,s as C,sa as F,sc as qe,t as w,ta as P,tb as He,u as ie,ua as G,uc as Ge,va as l,wa as v,wb as ue,wc as Ae,xa as A,xc as Qe,yb as re,z as d,za as I,zc as je}from"./chunk-KWICCDR6.js";import"./chunk-WWX6BADO.js";var ii=["*"],ni=(t,c,e,r,i,p)=>({"p-sidebar":!0,"p-sidebar-active":t,"p-sidebar-left":c,"p-sidebar-right":e,"p-sidebar-top":r,"p-sidebar-bottom":i,"p-sidebar-full":p}),oi=(t,c)=>({transform:t,transition:c}),ri=t=>({value:"visible",params:t});function ai(t,c){t&1&&de(0)}function si(t,c){if(t&1&&(Be(0),_(1,ai,1,0,"ng-container",5),Le()),t&2){let e=m(2);a(),s("ngTemplateOutlet",e.headlessTemplate)}}function li(t,c){t&1&&de(0)}function ci(t,c){t&1&&f(0,"TimesIcon",13),t&2&&(s("styleClass","p-sidebar-close-icon"),O("data-pc-section","closeicon"))}function mi(t,c){}function pi(t,c){t&1&&_(0,mi,0,0,"ng-template")}function di(t,c){if(t&1&&(o(0,"span",14),_(1,pi,1,0,null,5),n()),t&2){let e=m(4);O("data-pc-section","closeicon"),a(),s("ngTemplateOutlet",e.closeIconTemplate)}}function ui(t,c){if(t&1){let e=b();o(0,"button",10),g("click",function(i){d(e);let p=m(3);return u(p.close(i))})("keydown.enter",function(i){d(e);let p=m(3);return u(p.close(i))}),_(1,ci,1,2,"TimesIcon",11)(2,di,2,2,"span",12),n()}if(t&2){let e=m(3);O("aria-label",e.ariaCloseLabel)("data-pc-section","closebutton")("data-pc-group-section","iconcontainer"),a(),s("ngIf",!e.closeIconTemplate),a(),s("ngIf",e.closeIconTemplate)}}function _i(t,c){t&1&&de(0)}function gi(t,c){t&1&&de(0)}function fi(t,c){if(t&1&&(Be(0),o(1,"div",15),_(2,gi,1,0,"ng-container",5),n(),Le()),t&2){let e=m(3);a(),O("data-pc-section","footer"),a(),s("ngTemplateOutlet",e.footerTemplate)}}function hi(t,c){if(t&1&&(o(0,"div",6),_(1,li,1,0,"ng-container",5)(2,ui,3,5,"button",7),n(),o(3,"div",8),nt(4),_(5,_i,1,0,"ng-container",5),n(),_(6,fi,3,2,"ng-container",9)),t&2){let e=m(2);O("data-pc-section","header"),a(),s("ngTemplateOutlet",e.headerTemplate),a(),s("ngIf",e.showCloseIcon),a(),O("data-pc-section","content"),a(2),s("ngTemplateOutlet",e.contentTemplate),a(),s("ngIf",e.footerTemplate)}}function bi(t,c){if(t&1){let e=b();o(0,"div",3,0),g("@panelState.start",function(i){d(e);let p=m();return u(p.onAnimationStart(i))})("@panelState.done",function(i){d(e);let p=m();return u(p.onAnimationEnd(i))})("keydown",function(i){d(e);let p=m();return u(p.onKeyDown(i))}),_(2,si,2,1,"ng-container",4)(3,hi,7,6,"ng-template",null,1,lt),n()}if(t&2){let e=G(4),r=m();tt(r.styleClass),s("ngClass",st(9,ni,r.visible,r.position==="left"&&!r.fullScreen,r.position==="right"&&!r.fullScreen,r.position==="top"&&!r.fullScreen,r.position==="bottom"&&!r.fullScreen,r.fullScreen))("@panelState",x(19,ri,he(16,oi,r.transformOptions,r.transitionOptions)))("ngStyle",r.style),O("data-pc-name","sidebar")("data-pc-section","root"),a(2),s("ngIf",r.headlessTemplate)("ngIfElse",e)}}var yi=Qe([Ge({transform:"{{transform}}",opacity:0}),qe("{{transition}}")]),Ci=Qe([qe("{{transition}}",Ge({transform:"{{transform}}",opacity:0}))]),Pe=(()=>{class t{document;el;renderer;cd;config;appendTo;blockScroll=!1;style;styleClass;ariaCloseLabel;autoZIndex=!0;baseZIndex=0;modal=!0;dismissible=!0;showCloseIcon=!0;closeOnEscape=!0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";get visible(){return this._visible}set visible(e){this._visible=e}get position(){return this._position}set position(e){switch(this._position=e,e){case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break}}get fullScreen(){return this._fullScreen}set fullScreen(e){this._fullScreen=e,e&&(this.transformOptions="none")}templates;onShow=new ne;onHide=new ne;visibleChange=new ne;initialized;_visible;_position="left";_fullScreen=!1;container;transformOptions="translate3d(-100%, 0px, 0px)";mask;maskClickListener;documentEscapeListener;animationEndListener;contentTemplate;headerTemplate;footerTemplate;closeIconTemplate;headlessTemplate;constructor(e,r,i,p,h){this.document=e,this.el=r,this.renderer=i,this.cd=p,this.config=h}ngAfterViewInit(){this.initialized=!0}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this.contentTemplate=e.template;break;case"header":this.headerTemplate=e.template;break;case"footer":this.footerTemplate=e.template;break;case"closeicon":this.closeIconTemplate=e.template;break;case"headless":this.headlessTemplate=e.template;break;default:this.contentTemplate=e.template;break}})}onKeyDown(e){e.code==="Escape"&&this.hide(!1)}show(){this.autoZIndex&&ue.set("modal",this.container,this.baseZIndex||this.config.zIndex.modal),this.modal&&this.enableModality(),this.onShow.emit({}),this.visibleChange.emit(!0)}hide(e=!0){e&&this.onHide.emit({}),this.modal&&this.disableModality()}close(e){this.hide(!1),this.visibleChange.emit(!1),e.preventDefault()}enableModality(){let e=this.document.querySelectorAll(".p-sidebar-active"),i=e.length==1?String(parseInt(this.container.style.zIndex)-1):String(parseInt(e[0].style.zIndex)-1);this.mask||(this.mask=this.renderer.createElement("div"),this.renderer.setStyle(this.mask,"zIndex",i),le.addMultipleClasses(this.mask,"p-component-overlay p-sidebar-mask p-component-overlay p-component-overlay-enter"),this.dismissible&&(this.maskClickListener=this.renderer.listen(this.mask,"click",p=>{this.dismissible&&this.close(p)})),this.renderer.appendChild(this.document.body,this.mask),this.blockScroll&&le.blockBodyScroll())}disableModality(){this.mask&&(le.addClass(this.mask,"p-component-overlay-leave"),this.animationEndListener=this.renderer.listen(this.mask,"animationend",this.destroyModal.bind(this)))}destroyModal(){this.unbindMaskClickListener(),this.mask&&this.renderer.removeChild(this.document.body,this.mask),this.blockScroll&&le.unblockBodyScroll(),this.unbindAnimationEndListener(),this.mask=null}onAnimationStart(e){switch(e.toState){case"visible":this.container=e.element,this.appendContainer(),this.show(),this.closeOnEscape&&this.bindDocumentEscapeListener();break}}onAnimationEnd(e){switch(e.toState){case"void":this.hide(!0),ue.clear(this.container),this.unbindGlobalListeners();break}}appendContainer(){this.appendTo&&(this.appendTo==="body"?this.renderer.appendChild(this.document.body,this.container):le.appendChild(this.container,this.appendTo))}bindDocumentEscapeListener(){let e=this.el?this.el.nativeElement.ownerDocument:this.document;this.documentEscapeListener=this.renderer.listen(e,"keydown",r=>{r.which==27&&parseInt(this.container.style.zIndex)===ue.get(this.container)&&this.close(r)})}unbindDocumentEscapeListener(){this.documentEscapeListener&&(this.documentEscapeListener(),this.documentEscapeListener=null)}unbindMaskClickListener(){this.maskClickListener&&(this.maskClickListener(),this.maskClickListener=null)}unbindGlobalListeners(){this.unbindMaskClickListener(),this.unbindDocumentEscapeListener()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.initialized=!1,this.visible&&this.modal&&this.destroyModal(),this.appendTo&&this.container&&this.renderer.appendChild(this.el.nativeElement,this.container),this.container&&this.autoZIndex&&ue.clear(this.container),this.container=null,this.unbindGlobalListeners(),this.unbindAnimationEndListener()}static \u0275fac=function(r){return new(r||t)(oe(dt),oe(Ye),oe(Xe),oe(ct),oe(ht))};static \u0275cmp=w({type:t,selectors:[["p-sidebar"]],contentQueries:function(r,i,p){if(r&1&&rt(p,V,4),r&2){let h;F(h=P())&&(i.templates=h)}},hostAttrs:[1,"p-element"],inputs:{appendTo:"appendTo",blockScroll:[2,"blockScroll","blockScroll",$],style:"style",styleClass:"styleClass",ariaCloseLabel:"ariaCloseLabel",autoZIndex:[2,"autoZIndex","autoZIndex",$],baseZIndex:[2,"baseZIndex","baseZIndex",mt],modal:[2,"modal","modal",$],dismissible:[2,"dismissible","dismissible",$],showCloseIcon:[2,"showCloseIcon","showCloseIcon",$],closeOnEscape:[2,"closeOnEscape","closeOnEscape",$],transitionOptions:"transitionOptions",visible:"visible",position:"position",fullScreen:"fullScreen"},outputs:{onShow:"onShow",onHide:"onHide",visibleChange:"visibleChange"},features:[$e],ngContentSelectors:ii,decls:1,vars:1,consts:[["container",""],["notHeadless",""],["role","complementary",3,"ngClass","ngStyle","class","keydown",4,"ngIf"],["role","complementary",3,"keydown","ngClass","ngStyle"],[4,"ngIf","ngIfElse"],[4,"ngTemplateOutlet"],[1,"p-sidebar-header"],["type","button","class","p-sidebar-close p-sidebar-icon p-link","pRipple","",3,"click","keydown.enter",4,"ngIf"],[1,"p-sidebar-content"],[4,"ngIf"],["type","button","pRipple","",1,"p-sidebar-close","p-sidebar-icon","p-link",3,"click","keydown.enter"],[3,"styleClass",4,"ngIf"],["class","p-sidebar-close-icon",4,"ngIf"],[3,"styleClass"],[1,"p-sidebar-close-icon"],[1,"p-sidebar-footer"]],template:function(r,i){r&1&&(it(),_(0,bi,5,21,"div",2)),r&2&&s("ngIf",i.visible)},dependencies:()=>[Q,M,_t,ut,kt,ze],styles:[`@layer primeng{.p-sidebar{position:fixed;transition:transform .3s;display:flex;flex-direction:column}.p-sidebar-content{position:relative;overflow-y:auto;flex-grow:1}.p-sidebar-header{display:flex;align-items:center}.p-sidebar-footer{margin-top:auto}.p-sidebar-icon{display:flex;align-items:center;justify-content:center;margin-left:auto}.p-sidebar-left{top:0;left:0;width:20rem;height:100%}.p-sidebar-right{top:0;right:0;width:20rem;height:100%}.p-sidebar-top{top:0;left:0;width:100%;height:10rem}.p-sidebar-bottom{bottom:0;left:0;width:100%;height:10rem}.p-sidebar-full{width:100%;height:100%;top:0;left:0;-webkit-transition:none;transition:none}.p-sidebar-left.p-sidebar-sm,.p-sidebar-right.p-sidebar-sm{width:20rem}.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-md{width:40rem}.p-sidebar-left.p-sidebar-lg,.p-sidebar-right.p-sidebar-lg{width:60rem}.p-sidebar-top.p-sidebar-sm,.p-sidebar-bottom.p-sidebar-sm{height:10rem}.p-sidebar-top.p-sidebar-md,.p-sidebar-bottom.p-sidebar-md{height:20rem}.p-sidebar-top.p-sidebar-lg,.p-sidebar-bottom.p-sidebar-lg{height:30rem}@media screen and (max-width: 64em){.p-sidebar-left.p-sidebar-lg,.p-sidebar-left.p-sidebar-md,.p-sidebar-right.p-sidebar-lg,.p-sidebar-right.p-sidebar-md{width:20rem}}}
`],encapsulation:2,data:{animation:[Et("panelState",[Ae("void => visible",[je(yi)]),Ae("visible => void",[je(Ci)])])]},changeDetection:0})}return t})(),jt=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=ie({type:t});static \u0275inj=te({imports:[ye,It,Oe,ze,Oe]})}return t})();var vi=()=>({width:"75vw"}),Si=()=>({"1199px":"85vw","575px":"95vw"}),wi=()=>[10,15,50,100],xi=()=>["product_name","barcode"];function ki(t,c){t&1&&(o(0,"tr")(1,"th"),l(2,"Transaction #"),n(),o(3,"th"),l(4,"Datetime"),n(),o(5,"th"),l(6,"Type"),n(),o(7,"th"),l(8,"Quantity"),n()())}function Ii(t,c){if(t&1&&(o(0,"tr",8)(1,"td"),l(2),n(),o(3,"td"),l(4),n(),o(5,"td"),f(6,"p-tag",9),n(),o(7,"td"),l(8),n()()),t&2){let e=c.$implicit,r=m(2);s("pSelectableRow",e),a(2),v(e.transaction_notes||"---"),a(2),v(e.transaction_datetime),a(2),s("value",e.transaction_type)("severity",r.getSeverity(e.transaction_type)),a(2),v(e.quantity)}}function Ti(t,c){t&1&&(o(0,"tr")(1,"td",10),l(2,"No items yet!"),n()())}function Ei(t,c){if(t&1&&(o(0,"p-table",4,0),_(2,ki,9,0,"ng-template",5)(3,Ii,9,6,"ng-template",6)(4,Ti,3,0,"ng-template",7),n()),t&2){let e=m();s("value",e.stockHistory())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(8,wi))("alwaysShowPaginator",!0)("globalFilterFields",S(9,xi))("filterDelay",0)}}function Vi(t,c){if(t&1){let e=b();o(0,"p-button",11),g("onClick",function(){d(e);let i=m();return u(i.closeDialog())}),n()}}var Ne=(()=>{class t{constructor(){this.visible=!1,this.onClose=new ne,this.stockService=C(D),this.stockHistory=this.stockService.stockHistory}closeDialog(){this.visible=!1,this.onClose.emit()}fetchProductHistory(){this.stockService.fetchStockHistory(this.product_id)}getSeverity(e){switch(e){case"SALE":return"danger";case"SUPPLY":return"success";case"RETURN":return"success";case"DELETE":return"success";case"DISPOSE":return"danger";case"ADD":return"success";case"REMOVE":return"danger";default:return"contrast"}}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["stock-transactions"]],inputs:{product_id:"product_id",visible:"visible"},outputs:{onClose:"onClose"},standalone:!0,features:[at],decls:3,vars:11,consts:[["dt2",""],["position","top","header","Transaction History","styleClass","p-fluid",3,"visibleChange","onHide","onShow","modal","visible","breakpoints","closeOnEscape","closable","maximizable","dismissableMask"],["pTemplate","content"],["pTemplate","footer"],["styleClass","p-datatable-sm","dataKey","transaction_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"pSelectableRow"],[3,"value","severity"],["colspan","7"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick"]],template:function(r,i){r&1&&(o(0,"p-dialog",1),E("visibleChange",function(h){return T(i.visible,h)||(i.visible=h),h}),g("onHide",function(){return i.closeDialog()})("onShow",function(){return i.fetchProductHistory()}),_(1,Ei,5,10,"ng-template",2)(2,Vi,1,0,"ng-template",3),n()),r&2&&(q(S(9,vi)),s("modal",!0),I("visible",i.visible),s("breakpoints",S(10,Si))("closeOnEscape",!0)("closable",!0)("maximizable",!0)("dismissableMask",!0))},dependencies:[xe,K,V,Se,B,Ie,Y,J,Gt,qt]})}}return t})();var Mi=["tableSearch"],Bi=["barcodeInput"],Li=["itemName"],Hi=()=>[10,15,20,50,100],Oi=()=>["product_name","barcode"],ee=t=>({"ng-invalid ng-dirty":t}),qi=()=>({width:"65vw"});function Gi(t,c){if(t&1){let e=b();o(0,"span",41),f(1,"i",42),o(2,"input",43,3),g("input",function(i){d(e),m();let p=G(8);return u(p.filterGlobal(i.target.value,"contains"))}),n()(),o(4,"p-button",44),g("onClick",function(){d(e);let i=m();return u(i.refreshTable())}),n(),o(5,"p-button",45),g("onClick",function(){d(e);let i=m();return u(i.openItemDialog("add"))}),n()}if(t&2){let e=m(),r=G(8);a(2),s("value",r.filters.global==null?null:r.filters.global.value),a(2),s("loading",e.tableLoading())}}function Ai(t,c){if(t&1){let e=b();o(0,"p-button",46),g("onClick",function(){d(e);let i=m();return u(i.openStockDialog())}),n(),o(1,"p-button",47),g("onClick",function(){d(e);let i=m();return u(i.fetchHistory())}),n()}if(t&2){let e=m();s("disabled",!e.selectedProduct()||e.selectedProduct().stock_management==0),a(),s("disabled",!e.selectedProduct())("loading",e.historyLoading())}}function Qi(t,c){if(t&1){let e=b();o(0,"p-button",48),g("onClick",function(){d(e);let i=m();return u(i.openItemDialog("edit"))}),n(),o(1,"p-button",49),g("onClick",function(){d(e);let i=m();return u(i.deleteSelectedItem())}),n()}if(t&2){let e=m();s("disabled",!e.selectedProduct()),a(),s("disabled",!e.selectedProduct())}}function ji(t,c){t&1&&(o(0,"th",55),l(1," Cost "),n())}function zi(t,c){t&1&&(o(0,"th",55),l(1," Avg Cost "),n())}function Wi(t,c){if(t&1&&(o(0,"tr")(1,"th",50),l(2,"Barcode"),n(),o(3,"th",51),l(4,"Description"),n(),o(5,"th",52),l(6,"Category"),n(),o(7,"th",53),l(8,"Qty"),n(),_(9,ji,2,0,"th",54)(10,zi,2,0,"th",54),o(11,"th",55),l(12,"Price"),n(),o(13,"th",52),l(14,"Notes"),n()()),t&2){let e=m();a(9),s("ngIf",e.userPermissions().show_cost),a(),s("ngIf",e.userPermissions().show_cost)}}function Ui(t,c){if(t&1&&(o(0,"td"),l(1),R(2,"currency"),n()),t&2){let e=m().$implicit;a(),A(" ",N(2,1,e.unit_cost_usd)," ")}}function Zi(t,c){if(t&1&&(o(0,"td"),l(1),R(2,"currency"),n()),t&2){let e=m().$implicit;a(),A(" ",N(2,1,e.avg_cost_usd)," ")}}function Ki(t,c){if(t&1&&(o(0,"tr",56)(1,"td"),l(2),n(),o(3,"td"),l(4),n(),o(5,"td"),l(6),n(),o(7,"td"),l(8),n(),_(9,Ui,3,3,"td",57)(10,Zi,3,3,"td",57),o(11,"td"),l(12),R(13,"currency"),n(),o(14,"td"),l(15),n()()),t&2){let e=c.$implicit,r=c.rowIndex,i=m();et("glowing",i.glowingRowIndex()===r),s("pSelectableRow",e),a(2),v(e.barcode||"---"),a(2),v(e.product_name),a(2),v(e.category_name||"---"),a(2),A(" ",e.stock_management?e.quantity:"--"," "),a(),s("ngIf",i.userPermissions().show_cost),a(),s("ngIf",i.userPermissions().show_cost),a(2),v(N(13,11,e.unit_price_usd)),a(3),v(e.item_notes||"---")}}function Yi(t,c){t&1&&(o(0,"tr")(1,"td",58),l(2,"No items yet!"),n()())}function Ji(t,c){if(t&1&&(o(0,"h3"),l(1),n()),t&2){let e=m();a(),A("",e.dialogMode," Items")}}function Xi(t,c){t&1&&(o(0,"small",59),l(1,"Barcode already exists!"),n())}function $i(t,c){if(t&1){let e=b();o(0,"div",60)(1,"p-button",61),g("onClick",function(){d(e);let i=m();return u(i.generateBarcode())}),n()()}t&2&&(a(),s("tabindex",-1))}function en(t,c){t&1&&(o(0,"small",59),l(1,"Name is required."),n())}function tn(t,c){t&1&&(o(0,"div",26)(1,"label",62),l(2,"Initial Qty"),n(),f(3,"p-inputNumber",64),n())}function nn(t,c){if(t&1&&(_(0,tn,4,0,"div",32),o(1,"div",26)(2,"label",62),l(3,"Low Stock Threshold"),n(),f(4,"p-inputNumber",63),n()),t&2){let e=m();s("ngIf",e.dialogMode=="add")}}function on(t,c){t&1&&(o(0,"small",59),l(1,"Cost is required."),n())}function rn(t,c){if(t&1&&(o(0,"div",26)(1,"label",65),l(2,"Unit Cost"),o(3,"span",24),l(4,"*"),n()(),f(5,"p-inputNumber",66),_(6,on,2,0,"small",20),n()),t&2){let e=m();a(5),s("ngClass",x(2,ee,e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))),a(),s("ngIf",e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))}}function an(t,c){t&1&&(o(0,"small",59),l(1,"Price is required."),n())}function sn(t,c){if(t&1){let e=b();o(0,"button",67),g("click",function(){d(e);let i=m();return u(i.submitItem())}),n(),o(1,"button",68),g("click",function(){d(e);let i=m();return u(i.closeItemDialog())}),n()}if(t&2){let e=m();s("loading",e.submitItemLoading())}}function ln(t,c){if(t&1){let e=b();o(0,"form",14),g("ngSubmit",function(){d(e);let i=m();return u(i.submitStock())}),o(1,"div",15)(2,"div",69)(3,"label"),l(4,"Option"),o(5,"span",24),l(6,"*"),n()(),f(7,"p-dropdown",70),n(),o(8,"div",69)(9,"label"),l(10,"Quantity"),o(11,"span",24),l(12,"*"),n()(),f(13,"p-inputNumber",71),n(),o(14,"div",72)(15,"label"),l(16,"Notes"),n(),f(17,"input",73),n()()()}if(t&2){let e=m();s("formGroup",e.stockForm),a(7),s("autoOptionFocus",!1)("options",e.transactionOptions)("ngClass",x(6,ee,(e.transaction_type==null?null:e.transaction_type.invalid)&&((e.transaction_type==null?null:e.transaction_type.dirty)||(e.transaction_type==null?null:e.transaction_type.touched)||e.submitted))),a(6),s("ngClass",x(8,ee,(e.quantity==null?null:e.quantity.invalid)&&((e.quantity==null?null:e.quantity.dirty)||(e.quantity==null?null:e.quantity.touched)||e.submitted))),a(4),s("ngClass",x(10,ee,(e.transaction_notes==null?null:e.transaction_notes.invalid)&&((e.transaction_notes==null?null:e.transaction_notes.dirty)||(e.transaction_notes==null?null:e.transaction_notes.touched)||e.submitted)))}}function cn(t,c){if(t&1){let e=b();o(0,"p-button",74),g("onClick",function(){d(e);let i=m();return u(i.toggleStockDialog())}),n(),o(1,"p-button",75),g("onClick",function(){d(e);let i=m();return u(i.submitStock())}),n()}}var Zt=(()=>{class t{constructor(){this.subscriptions=new ge,this.barcodeError=!1,this.stockService=C(D),this.fb=C(se),this.confirmationService=C(re),this.authService=C(Ce),this.rowsPerPage=this.stockService.rowsPerPage,this.products=this.stockService.products,this.itemSidebarVisible=this.stockService.itemSidebarVisible,this.tableLoading=this.stockService.tableLoading,this.submitItemLoading=this.stockService.submitItemLoading,this.categories=this.stockService.categories,this.submitted=!1,this.selectedProduct=this.stockService.selectedProduct,this.userPermissions=this.authService.userPermissions,this.itemForm=this.fb.group({product_id:[null],category_id_fk:[{value:null,disabled:!1}],product_name:[null,k.required],barcode:[null],unit_cost_usd:[null,k.required],unit_price_usd:[null,k.required],quantity:[null],product_notes:[null],low_stock_threshold:[null],stock_management:[!0]}),this.stockDialogVisible=this.stockService.stockDialogVisible,this.transactionOptions=[{name:"Add",value:"ADD"},{name:"Remove",value:"REMOVE"}],this.stockForm=this.fb.group({product_id_fk:[null],transaction_type:[{value:null,disabled:!1},k.required],quantity:[null,k.required],transaction_notes:[null,k.required]}),this.historyDialogVisible=this.stockService.historyDialogVisible,this.historyLoading=this.stockService.historyLoading,this.generatedBarcode=null,this.glowingRowIndex=this.stockService.glowingRowIndex}onKeyDown(e){!this.itemSidebarVisible()&&!this.stockDialogVisible()&&this.tableSearch.nativeElement.focus()}ngOnInit(){this.subscriptions.add(this.stockService.barcodeError.subscribe(()=>{this.barcodeInput.nativeElement.select(),this.barcodeError=!0})),this.subscriptions.add(this.stockService.itemCreated.subscribe(()=>{this.resetDialog()})),this.subscriptions.add(this.stockService.generatedBarcode.subscribe(e=>{e&&this.itemForm.patchValue({barcode:e})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}updateRowsPerPage(e){this.stockService.updateRowsPerPage(e)}get category_id_fk(){return this.itemForm.get("category_id_fk")}get product_name(){return this.itemForm.get("product_name")}get unit_cost_usd(){return this.itemForm.get("unit_cost_usd")}get unit_price_usd(){return this.itemForm.get("unit_price_usd")}get stock_management(){return this.itemForm.get("stock_management")}focusInput(){this.barcodeInput.nativeElement.focus()}clearBarcode(){this.itemForm.patchValue({barcode:null})}openItemDialog(e){this.dialogMode=e,this.dialogMode=="add"?this.stockService.itemSidebarVisible.set(!0):this.dialogMode=="edit"&&(this.selectedProduct().stock_management=this.selectedProduct().stock_management==1,this.itemForm.patchValue(this.selectedProduct()),this.stockService.itemSidebarVisible.set(!0))}closeItemDialog(){this.stockService.itemSidebarVisible.set(!1)}resetDialog(){this.submitted=!1,this.itemForm.reset({stock_management:!0})}submitItem(){this.submitted=!0,this.clearBarcodeError(),this.dialogMode=="add"?this.itemForm.valid&&(this.itemForm.controls.barcode.value==""&&this.itemForm.patchValue({barcode:null}),this.stockService.createItem(this.itemForm.value),this.submitted=!1,this.focusInput()):this.itemForm.valid&&this.stockService.updateItem(this.itemForm.value)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:"Are you sure you want to delete selected item?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedProduct())}})}refreshTable(){this.stockService.getItems()}clearBarcodeError(){this.barcodeError=!1}get transaction_type(){return this.stockForm.get("transaction_type")}get quantity(){return this.stockForm.get("quantity")}get transaction_notes(){return this.stockForm.get("transaction_notes")}openStockDialog(){this.stockService.stockDialogVisible.set(!0)}toggleStockDialog(){this.stockService.stockDialogVisible.set(!1)}submitStock(){this.submitted=!0,this.stockForm.valid&&(this.stockForm.patchValue({product_id_fk:this.selectedProduct()?.product_id}),this.stockService.submitStock(this.stockForm.value))}resetStockDialog(){this.submitted=!1,this.stockForm.reset(),this.stockService.stockDialogVisible.set(!1)}fetchHistory(){this.stockService.fetchStockHistory(this.selectedProduct().product_id)}closeHistoryDialog(){this.stockService.historyDialogVisible.set(!1)}generateBarcode(){this.clearBarcodeError(),this.stockService.generateBarcode()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-inventory"]],viewQuery:function(r,i){if(r&1&&(H(Mi,5),H(Bi,5),H(Li,5)),r&2){let p;F(p=P())&&(i.tableSearch=p.first),F(p=P())&&(i.barcodeInput=p.first),F(p=P())&&(i.itemName=p.first)}},hostBindings:function(r,i){r&1&&g("keydown",function(h){return i.onKeyDown(h)},!1,Je)},decls:65,vars:42,consts:[["dt2",""],["barcodeInput",""],["itemName",""],["tableSearch",""],[1,"grid","m-1"],[1,"col-12"],["pTemplate","left"],["pTemplate","center"],["pTemplate","right"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","65vh",3,"selectionChange","rowsChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","globalFilterFields","filterDelay","loading","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","right","styleClass","w-30rem",3,"visibleChange","onShow","onHide","visible"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-8"],["for","barcode"],[1,"pi","pi-barcode"],["placeholder","Barcode ...","pInputText","","spellcheck","false","formControlName","barcode",1,"w-full","p-inputtext-sm",3,"input","ngClass"],["class","p-error",4,"ngIf"],["class","field col-4 flex align-items-end",4,"ngIf"],[1,"field","col-12"],["for","name"],[1,"text-red-600"],["placeholder","Product Name","id","name","pInputText","","formControlName","product_name","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngClass"],[1,"field","col-6"],["for","Category"],["styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","formControlName","category_id_fk","optionLabel","category_name","optionValue","category_id","placeholder","Select Category ...","filterBy","category_name",3,"autoOptionFocus","showClear","options","filter"],[1,"flex","align-items-center","gap-1"],["formControlName","stock_management","inputId","stock_management",3,"binary"],["for","stock_management"],["class","field col-6",4,"ngIf"],["for","unit_price_usd"],["styleClass","w-full","formControlName","unit_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["for","product_notes"],["type","text","pInputText","","formControlName","product_notes","spellcheck","false",1,"w-full"],["pTemplate","footer"],["header","Stock Correction","styleClass","p-fluid","position","top",3,"onHide","visible","modal"],["pTemplate","content"],[3,"onClose","visible","product_id"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","mx-2 ",3,"onClick","loading"],["label","New","icon","pi pi-plus","severity","success","size","small",3,"onClick"],["label","Correct Stock","size","small","severity","info","icon","pi pi-wrench",3,"onClick","disabled"],["label","History","size","small","severity","contrast","icon","pi pi-history","styleClass","ml-2",3,"onClick","disabled","loading"],["pp-button","","pRipple","","label","Edit","icon","pi pi-file-edit","size","small","severity","warning",3,"onClick","disabled"],["pp-button","","pRipple","","label","Delete","icon","pi pi-trash","size","small","severity","danger",1,"ml-2",3,"onClick","disabled"],["width","10%"],["width","35%"],["width","15%"],["width","4%"],["width","7%",4,"ngIf"],["width","7%"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","7"],[1,"p-error"],[1,"field","col-4","flex","align-items-end"],["label","Generate","severity","contrast",3,"onClick","tabindex"],["for","qty"],["styleClass","w-full","formControlName","low_stock_threshold","placeholder","low stock qty",1,"p-inputtext-sm","w-full"],["styleClass","w-full","formControlName","quantity","placeholder","Initial Qty",1,"p-inputtext-sm","w-full"],["for","unit_cost_usd"],["styleClass","w-full","formControlName","unit_cost_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["type","submit","pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success","w-full","mb-3",3,"click","loading"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary","w-full",3,"click"],[1,"field","col-12","md:col-3"],["scrollHeight","400px","appendTo","body","formControlName","transaction_type","optionLabel","name","optionValue","value","placeholder","transaction type ...",3,"autoOptionFocus","options","ngClass"],["formControlName","quantity",3,"ngClass"],[1,"field","col-12","md:col-6"],["type","text","spellcheck","false","pInputText","","formControlName","transaction_notes",1,"w-full",3,"ngClass"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Save","icon","pi pi-check","severity","success","size","small",3,"onClick"]],template:function(r,i){if(r&1){let p=b();o(0,"div",4)(1,"div",5)(2,"p-card")(3,"p-toolbar"),_(4,Gi,6,2,"ng-template",6)(5,Ai,2,3,"ng-template",7)(6,Qi,2,2,"ng-template",8),n(),o(7,"p-table",9,0),E("selectionChange",function(y){return d(p),T(i.selectedProduct,y)||(i.selectedProduct=y),u(y)}),g("rowsChange",function(y){return d(p),u(i.updateRowsPerPage(y))}),_(9,Wi,15,2,"ng-template",10)(10,Ki,16,13,"ng-template",11)(11,Yi,3,0,"ng-template",12),n()()()(),o(12,"p-sidebar",13),E("visibleChange",function(y){return d(p),T(i.itemSidebarVisible,y)||(i.itemSidebarVisible=y),u(y)}),g("onShow",function(){return d(p),u(i.focusInput())})("onHide",function(){return d(p),u(i.resetDialog())}),_(13,Ji,2,1,"ng-template",10),o(14,"form",14),g("ngSubmit",function(){return d(p),u(i.submitItem())}),o(15,"div",15)(16,"div",16)(17,"label",17),l(18,"Barcode"),n(),o(19,"p-inputGroup")(20,"p-inputGroupAddon"),f(21,"i",18),n(),o(22,"input",19,1),g("input",function(){return d(p),u(i.clearBarcodeError())}),n()(),_(24,Xi,2,0,"small",20),n(),_(25,$i,2,1,"div",21),o(26,"div",22)(27,"label",23),l(28,"Product Name"),o(29,"span",24),l(30,"*"),n()(),f(31,"input",25,2),_(33,en,2,0,"small",20),n(),o(34,"div",26)(35,"label",27),l(36,"Category"),n(),f(37,"p-dropdown",28),n(),o(38,"div",26)(39,"label"),l(40,"Stock Management"),n(),f(41,"br"),o(42,"div",29),f(43,"p-checkbox",30),o(44,"label",31),l(45,"Enable"),n()()(),_(46,nn,5,1),n(),o(47,"div",15),_(48,rn,7,4,"div",32),o(49,"div",26)(50,"label",33),l(51,"Unit price"),o(52,"span",24),l(53,"*"),n()(),f(54,"p-inputNumber",34),_(55,an,2,0,"small",20),n(),o(56,"div",22)(57,"label",35),l(58,"Notes"),n(),f(59,"input",36),n()()(),_(60,sn,2,1,"ng-template",37),n(),o(61,"p-dialog",38),g("onHide",function(){return d(p),u(i.resetStockDialog())}),_(62,ln,18,12,"ng-template",39)(63,cn,2,0,"ng-template",37),n(),o(64,"stock-transactions",40),g("onClose",function(){return d(p),u(i.closeHistoryDialog())}),n()}if(r&2){let p,h;a(7),s("value",i.products()),I("selection",i.selectedProduct),s("paginator",!0)("rows",i.rowsPerPage())("showCurrentPageReport",!0)("rowsPerPageOptions",S(33,Hi))("alwaysShowPaginator",!0)("globalFilterFields",S(34,Oi))("filterDelay",0)("loading",i.tableLoading())("scrollable",!0),a(5),I("visible",i.itemSidebarVisible),a(2),s("formGroup",i.itemForm),a(8),s("ngClass",x(35,ee,i.barcodeError)),a(2),s("ngIf",i.barcodeError),a(),s("ngIf",i.dialogMode=="add"||!((p=i.selectedProduct())!=null&&p.have_barcode)),a(6),s("ngClass",x(37,ee,i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted))),a(2),s("ngIf",i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted)),a(4),s("autoOptionFocus",!1)("showClear",!0)("options",i.categories())("filter",!0),a(6),s("binary",!0),a(3),fe(i.stock_management.value?46:-1),a(2),s("ngIf",i.userPermissions().show_cost),a(6),s("ngClass",x(39,ee,i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted))),a(),s("ngIf",i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted)),a(6),q(S(41,qi)),s("visible",i.stockDialogVisible())("modal",!0),a(3),s("visible",i.historyDialogVisible())("product_id",(h=i.selectedProduct())==null?null:h.product_id)}},dependencies:[Q,M,W,ae,j,z,U,Z,Y,V,J,X,ce,B,K,ke,me,pe,wt,Pe,Ee,Ve,Ne,Te,be],styles:["[_nghost-%COMP%]  .p-card-content{padding:0!important}[_nghost-%COMP%]  .p-toolbar{padding-top:.6rem!important;padding-bottom:.6rem!important}"]})}}return t})();var Kt=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-stock-home"]],decls:1,vars:0,template:function(r,i){r&1&&f(0,"router-outlet")},dependencies:[ft]})}}return t})();var mn=["rateInput"],pn=()=>({width:"35vw"}),dn=()=>({"1199px":"85vw","575px":"95vw"});function un(t,c){if(t&1){let e=b();o(0,"form",8),g("ngSubmit",function(){d(e);let i=m();return u(i.submit())}),o(1,"div",9)(2,"label",10),l(3,"Exchange Rate"),n(),f(4,"p-inputNumber",11,0),n()()}if(t&2){let e=m();s("formGroup",e.rateForm),a(4),s("min",1e3)}}function _n(t,c){if(t&1){let e=b();o(0,"p-button",12),g("onClick",function(){d(e);let i=m();return u(i.toggleDialog(!1))}),n(),o(1,"p-button",13),g("onClick",function(){d(e);let i=m();return u(i.submit())}),n()}}var Yt=(()=>{class t{constructor(){this.stockService=C(D),this.formBuilder=C(se),this.exchangeRate=this.stockService.exchangeRate,this.rateDialogVisible=this.stockService.rateDialogVisible,this.dialogVisible=!1,pt(()=>{this.rateForm=this.formBuilder.group({rate_value:[this.exchangeRate().rate_value]})})}toggleDialog(e){this.stockService.rateDialogVisible.set(e),setTimeout(()=>{this.rateInput&&this.rateInput.input.nativeElement.select()},50)}submit(){this.rateForm.valid&&this.stockService.updateExchangeRate(this.rateForm.value)}resetDialog(){this.rateForm.reset({rate_value:this.exchangeRate().rate_value}),this.stockService.rateDialogVisible.set(!1)}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["exchange-rate"]],viewQuery:function(r,i){if(r&1&&H(mn,5),r&2){let p;F(p=P())&&(i.rateInput=p.first)}},decls:12,vars:10,consts:[["rateInput",""],[1,"p-toolbar-group-start"],[1,"text-green-600"],[1,"p-toolbar-group-end"],["icon","pi pi-file-edit","styleClass","p-button-warning","label","Edit",3,"onClick"],["header","Exchange Rate","styleClass","p-fluid",3,"visibleChange","onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["formControlName","rate_value",3,"min"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Save","icon","pi pi-check","severity","success","size","small",3,"onClick"]],template:function(r,i){r&1&&(o(0,"p-toolbar")(1,"div",1)(2,"h3"),l(3," Dollar Exchange: "),o(4,"i",2),l(5),R(6,"lira"),n()()(),o(7,"div",3)(8,"p-button",4),g("onClick",function(){return i.toggleDialog(!0)}),n()()(),o(9,"p-dialog",5),E("visibleChange",function(h){return T(i.rateDialogVisible,h)||(i.rateDialogVisible=h),h}),g("onHide",function(){return i.resetDialog()}),_(10,un,6,2,"ng-template",6)(11,_n,2,0,"ng-template",7),n()),r&2&&(a(5),v(N(6,6,i.exchangeRate().rate_value)),a(4),q(S(8,pn)),I("visible",i.rateDialogVisible),s("modal",!0)("breakpoints",S(9,dn)))},dependencies:[W,j,z,U,Z,V,X,B,K,pe,Mt]})}}return t})();var Jt=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["stock-settings"]],decls:5,vars:0,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"]],template:function(r,i){r&1&&(o(0,"div",0)(1,"div",1),f(2,"exchange-rate"),n(),o(3,"div",1),f(4,"stock-value"),n()())},dependencies:[De,Yt]})}}return t})();var hn=()=>[10,15,50,100],bn=()=>["category_name"],yn=()=>({width:"35vw"}),Cn=()=>({"1199px":"75vw","575px":"85vw"}),vn=(t,c)=>({" pi-check-circle text-green-600":t,"pi-times-circle text-red-600":c}),Sn=t=>({"ng-invalid ng-dirty":t});function wn(t,c){if(t&1){let e=b();o(0,"span",13),f(1,"i",14),o(2,"input",15,1),g("input",function(i){d(e),m();let p=G(5);return u(p.filterGlobal(i.target.value,"contains"))}),n()(),o(4,"p-button",16),g("onClick",function(){d(e);let i=m();return u(i.refreshCategories())}),n(),o(5,"p-button",17),g("onClick",function(){d(e);let i=m();return u(i.openCategoryDialog("add"))}),n()}if(t&2){let e=m(),r=G(5);a(2),s("value",r.filters.global==null?null:r.filters.global.value),a(2),s("loading",e.categoriesLoading())}}function xn(t,c){if(t&1){let e=b();o(0,"p-button",18),g("onClick",function(){d(e);let i=m();return u(i.openCategoryDialog("edit"))}),n(),o(1,"p-button",19),g("onClick",function(){d(e);let i=m();return u(i.deleteSelectedCategory())}),n()}if(t&2){let e=m();s("disabled",!e.selectedCategory()),a(),s("disabled",!e.selectedCategory())}}function kn(t,c){t&1&&(o(0,"tr")(1,"th",20),l(2,"Sort"),n(),o(3,"th",21),l(4,"Name"),n(),o(5,"th",22),l(6,"Visible?"),n()())}function In(t,c){if(t&1&&(o(0,"tr",23)(1,"td"),f(2,"span",24),n(),o(3,"td"),l(4),n(),o(5,"td"),f(6,"i",25),n()()),t&2){let e=c.$implicit,r=c.rowIndex;s("pReorderableRow",r)("pSelectableRow",e),a(4),v(e.category_name),a(2),s("ngClass",he(4,vn,e.show_on_sell,!e.show_on_sell))}}function Tn(t,c){t&1&&(o(0,"tr")(1,"td",26),l(2,"No Categories yet!"),n()())}function En(t,c){t&1&&(o(0,"small",35),l(1,"Name is required."),n())}function Vn(t,c){if(t&1){let e=b();o(0,"form",27),g("ngSubmit",function(){d(e);let i=m();return u(i.submitCategory())}),o(1,"div",28)(2,"label",29),l(3,"Category Name"),n(),f(4,"input",30),_(5,En,2,0,"small",31),n(),o(6,"div",32),f(7,"p-inputSwitch",33),o(8,"label",34),l(9,"Show on sell page?"),n()()()}if(t&2){let e=m();s("formGroup",e.categoryForm),a(4),s("ngClass",x(3,Sn,(e.category_name==null?null:e.category_name.invalid)&&((e.category_name==null?null:e.category_name.dirty)||(e.category_name==null?null:e.category_name.touched)))),a(),s("ngIf",(e.category_name==null?null:e.category_name.invalid)&&((e.category_name==null?null:e.category_name.dirty)||(e.category_name==null?null:e.category_name.touched)))}}function Dn(t,c){if(t&1){let e=b();o(0,"button",36),g("click",function(){d(e);let i=m();return u(i.categoryDialogVisible.set(!1))}),n(),o(1,"button",37),g("click",function(){d(e);let i=m();return u(i.submitCategory())}),n()}}var Xt=(()=>{class t{constructor(){this.stockService=C(D),this.confirmationService=C(re),this.notificationService=C(bt),this.categoryDialogVisible=this.stockService.categoryDialogVisible,this.categories=this.stockService.categories,this.categoriesLoading=this.stockService.categoriesLoading,this.selectedCategory=this.stockService.selectedCategory,this.categoryForm=new yt({category_id:new ve,category_name:new ve(null,k.required),show_on_sell:new ve(!1)})}sortCategories(){this.stockService.sortCategories()}selectCategory(){this.stockService.getFilteredItems(this.selectedCategory(),"stock")}refreshCategories(){this.stockService.getCategories()}get category_name(){return this.categoryForm.get("category_name")}openCategoryDialog(e){this.dialogMode=e,this.dialogMode=="add"?this.stockService.categoryDialogVisible.set(!0):(this.categoryForm.patchValue({category_id:this.selectedCategory()?.category_id,category_name:this.selectedCategory()?.category_name,show_on_sell:this.selectedCategory()?.show_on_sell==1}),this.stockService.categoryDialogVisible.set(!0))}submitCategory(){this.dialogMode=="add"?this.categoryForm.valid&&(this.stockService.createCategory(this.categoryForm.value),this.stockService.categoryDialogVisible.set(!1)):this.dialogMode=="edit"&&this.categoryForm.valid&&(this.stockService.updateCategory(this.categoryForm.value),this.stockService.selectedCategory.set(null))}deleteSelectedCategory(){this.stockService.filteredItems().length!=0?this.notificationService.showError("Delete all category items before proceeding!","home"):this.confirmationService.confirm({key:"home",message:`Are you sure that you want to delete "${this.selectedCategory()?.category_name}"?`,header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteCategory(this.selectedCategory().category_id)}})}resetDialog(){this.categoryForm.reset({category_name:null,show_on_sell:!1})}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["categories"]],decls:12,vars:20,consts:[["ct",""],["tableSearch",""],["header","Categories"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["selectionMode","single","dataKey","category_id","styleClass","p-datatable-sm","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} records","scrollHeight","55vh",3,"selectionChange","onRowReorder","onRowSelect","value","selection","loading","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","scrollable","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["header","Category","styleClass","p-fluid",3,"onHide","visible","modal","breakpoints"],["pTemplate","content"],["pTemplate","footer"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search ...",1,"p-inputtext-sm",3,"input","value"],["label","Refresh","icon","pi pi-refresh","size","small","styleClass","mx-2",3,"onClick","loading"],["label","New Category","icon","pi pi-plus","severity","success","size","small",3,"onClick"],["label","Edit","icon","pi pi-file-edit","severity","warning","size","small",1,"mr-2",3,"onClick","disabled"],["label","Delete","icon","pi pi-trash","severity","danger","size","small",3,"onClick","disabled"],["width","10%"],["width","75%"],["width","15%"],[3,"pReorderableRow","pSelectableRow"],["pReorderableRowHandle","",1,"pi","pi-bars"],[1,"pi",3,"ngClass"],["colspan","3"],[3,"ngSubmit","formGroup"],[1,"field","mt-1"],["for","name"],["type","text","pInputText","","formControlName","category_name","required","","autofocus","","spellcheck","false",3,"ngClass"],["class","p-error",4,"ngIf"],[1,"flex","align-items-center","justify-content-center","gap-2"],["id","showOnSell","formControlName","show_on_sell"],["for","showOnSell"],[1,"p-error"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success",3,"click"]],template:function(r,i){if(r&1){let p=b();o(0,"p-panel",2)(1,"p-toolbar",3),_(2,wn,6,2,"ng-template",4)(3,xn,2,2,"ng-template",5),n(),o(4,"p-table",6,0),E("selectionChange",function(y){return d(p),T(i.selectedCategory,y)||(i.selectedCategory=y),u(y)}),g("onRowReorder",function(){return d(p),u(i.sortCategories())})("onRowSelect",function(){return d(p),u(i.selectCategory())}),_(6,kn,7,0,"ng-template",7)(7,In,7,7,"ng-template",8)(8,Tn,3,0,"ng-template",9),n()(),o(9,"p-dialog",10),g("onHide",function(){return d(p),u(i.resetDialog())}),_(10,Vn,10,5,"ng-template",11)(11,Dn,2,0,"ng-template",12),n()}r&2&&(a(4),s("value",i.categories()),I("selection",i.selectedCategory),s("loading",i.categoriesLoading())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(16,hn))("alwaysShowPaginator",!0)("scrollable",!0)("globalFilterFields",S(17,bn))("filterDelay",0),a(5),q(S(18,yn)),s("visible",i.categoryDialogVisible())("modal",!0)("breakpoints",S(19,Cn)))},dependencies:[Q,M,W,ae,j,z,Ct,U,Z,Y,V,J,Pt,Rt,X,ce,B,K,me,we,At]})}}return t})();var Pn=["barcodeInput"],Rn=["itemName"],Nn=()=>[10,25,50],Me=t=>({"ng-invalid ng-dirty":t});function Mn(t,c){if(t&1){let e=b();o(0,"button",36),g("click",function(){d(e);let i=m();return u(i.openItemDialog("add"))}),n()}}function Bn(t,c){if(t&1){let e=b();o(0,"button",37),g("click",function(){d(e);let i=m();return u(i.openItemDialog("edit"))}),n(),o(1,"button",38),g("click",function(){d(e);let i=m();return u(i.deleteSelectedItem())}),n()}if(t&2){let e=m();s("disabled",!e.selectedItem),a(),s("disabled",!e.selectedItem)}}function Ln(t,c){t&1&&(o(0,"th",43),l(1,"Cost"),n())}function Hn(t,c){if(t&1&&(o(0,"tr")(1,"th",39),l(2,"Barcode"),n(),o(3,"th",40),l(4,"Name"),n(),o(5,"th",41),l(6,"Qty"),n(),_(7,Ln,2,0,"th",42),o(8,"th",43),l(9,"Price"),n()()),t&2){let e=m();a(7),s("ngIf",e.userPermissions().show_cost)}}function On(t,c){if(t&1&&(o(0,"td"),l(1),R(2,"currency"),n()),t&2){let e=m().$implicit;a(),A(" ",N(2,1,e.unit_cost_usd)," ")}}function qn(t,c){if(t&1&&(o(0,"tr",44)(1,"td"),l(2),n(),o(3,"td"),l(4),n(),o(5,"td"),l(6),n(),_(7,On,3,3,"td",45),o(8,"td"),l(9),R(10,"currency"),n()()),t&2){let e=c.$implicit,r=m();s("pSelectableRow",e),a(2),v(e.barcode||" --- "),a(2),v(e.product_name),a(2),v(e.quantity),a(),s("ngIf",r.userPermissions().show_cost),a(2),v(N(10,6,e.unit_price_usd))}}function Gn(t,c){t&1&&(o(0,"tr")(1,"td",46),l(2,"No items yet!"),n()())}function An(t,c){if(t&1&&(o(0,"h3"),l(1),n()),t&2){let e=m();a(),A("",e.dialogMode," Items")}}function Qn(t,c){t&1&&(o(0,"small",47),l(1,"Barcode already exists!"),n())}function jn(t,c){if(t&1){let e=b();o(0,"div",48)(1,"p-button",49),g("onClick",function(){d(e);let i=m();return u(i.generateBarcode())}),n()()}}function zn(t,c){t&1&&(o(0,"small",47),l(1,"Name is required."),n())}function Wn(t,c){t&1&&(o(0,"div",24)(1,"label",50),l(2,"Initial Qty"),n(),f(3,"p-inputNumber",52),n())}function Un(t,c){if(t&1&&(_(0,Wn,4,0,"div",30),o(1,"div",24)(2,"label",50),l(3,"Low Stock Threshold"),n(),f(4,"p-inputNumber",51),n()),t&2){let e=m();s("ngIf",e.dialogMode=="add")}}function Zn(t,c){t&1&&(o(0,"small",47),l(1,"Cost is required."),n())}function Kn(t,c){if(t&1&&(o(0,"div",24)(1,"label",53),l(2,"Unit Cost"),o(3,"span",22),l(4,"*"),n()(),f(5,"p-inputNumber",54),_(6,Zn,2,0,"small",18),n()),t&2){let e=m();a(5),s("ngClass",x(2,Me,e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))),a(),s("ngIf",e.unit_cost_usd.invalid&&(e.unit_cost_usd.dirty||e.unit_cost_usd.touched||e.submitted))}}function Yn(t,c){t&1&&(o(0,"small",47),l(1,"Price is required."),n())}function Jn(t,c){if(t&1){let e=b();o(0,"button",55),g("click",function(){d(e);let i=m();return u(i.submitItem())}),n(),o(1,"button",56),g("click",function(){d(e);let i=m();return u(i.closeItemDialog())}),n()}if(t&2){let e=m();s("loading",e.submitItemLoading())}}var $t=(()=>{class t{constructor(){this.stockService=C(D),this.authService=C(Ce),this.fb=C(se),this.confirmationService=C(re),this.userPermissions=this.authService.userPermissions,this.selectedCategory=this.stockService.selectedCategory,this.filteredItems=this.stockService.filteredItems,this.categories=this.stockService.categories,this.submitted=!1,this.itemSidebarVisible=this.stockService.itemSidebarVisible,this.tableLoading=this.stockService.tableLoading,this.submitItemLoading=this.stockService.submitItemLoading,this.subscriptions=new ge,this.barcodeError=!1,this.itemForm=this.fb.group({product_id:[null],category_id_fk:[{value:null,disabled:!1}],product_name:[null,k.required],barcode:[null],unit_cost_usd:[null,k.required],unit_price_usd:[null,k.required],quantity:[null],product_notes:[null],low_stock_threshold:[null],stock_management:[!0]}),this.generatedBarcode=null}ngOnInit(){this.subscriptions.add(this.stockService.barcodeError.subscribe(()=>{this.barcodeInput.nativeElement.select(),this.barcodeError=!0})),this.subscriptions.add(this.stockService.itemCreated.subscribe(()=>{this.resetDialog()})),this.subscriptions.add(this.stockService.generatedBarcode.subscribe(e=>{e&&this.itemForm.patchValue({barcode:e})}))}ngOnDestroy(){this.subscriptions.unsubscribe()}get category_id_fk(){return this.itemForm.get("category_id_fk")}get product_name(){return this.itemForm.get("product_name")}get unit_cost_usd(){return this.itemForm.get("unit_cost_usd")}get unit_price_usd(){return this.itemForm.get("unit_price_usd")}get stock_management(){return this.itemForm.get("stock_management")}openItemDialog(e){this.dialogMode=e,this.dialogMode=="add"?(this.itemForm.patchValue({category_id_fk:this.selectedCategory().category_id}),this.stockService.itemSidebarVisible.set(!0)):this.dialogMode=="edit"&&(this.selectedItem.stock_management=this.selectedItem.stock_management==1,this.itemForm.patchValue(this.selectedItem),this.stockService.itemSidebarVisible.set(!0))}submitItem(){this.submitted=!0,this.dialogMode=="add"?this.itemForm.valid&&(this.itemForm.controls.barcode.value==""&&this.itemForm.patchValue({barcode:null}),this.stockService.createItem(this.itemForm.value),this.submitted=!1,this.focusInput()):this.itemForm.valid&&(this.stockService.updateItem(this.itemForm.value),this.selectedItem=null)}deleteSelectedItem(){this.confirmationService.confirm({key:"home",message:"Are you sure you want to delete selected item?",header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.stockService.deleteItem(this.selectedItem),this.selectedItem=null}})}refreshTable(){this.stockService.getItems()}focusInput(){this.barcodeInput.nativeElement.focus()}clearBarcode(){this.itemForm.patchValue({barcode:null})}clearBarcodeError(){this.barcodeError=!1}resetDialog(){this.submitted=!1,this.itemForm.reset({stock_management:!0,category_id_fk:this.selectedCategory()?.category_id})}closeItemDialog(){this.stockService.itemSidebarVisible.set(!1)}generateBarcode(){this.stockService.generateBarcode()}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["category-items"]],viewQuery:function(r,i){if(r&1&&(H(Pn,5),H(Rn,5)),r&2){let p;F(p=P())&&(i.barcodeInput=p.first),F(p=P())&&(i.itemName=p.first)}},decls:59,vars:33,consts:[["dt",""],["barcodeInput",""],["itemName",""],[3,"header"],["styleClass","mb-4 p-2"],["pTemplate","left"],["pTemplate","right"],["styleClass","p-datatable-sm","selectionMode","single","dataKey","product_id",3,"selectionChange","value","selection","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["position","right","styleClass","w-30rem",3,"visibleChange","onShow","onHide","visible"],[3,"ngSubmit","formGroup"],[1,"formgrid","grid"],[1,"field","col-8"],["for","barcode"],[1,"pi","pi-barcode"],["placeholder","Barcode ...","pInputText","","spellcheck","false","formControlName","barcode",1,"w-full","p-inputtext-sm",3,"input","ngClass"],["class","p-error",4,"ngIf"],["class","field col-4 flex align-items-end",4,"ngIf"],[1,"field","col-12"],["for","name"],[1,"text-red-600"],["placeholder","Product Name","id","name","pInputText","","formControlName","product_name","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngClass"],[1,"field","col-6"],["for","Category"],["styleClass","p-inputtext-sm","scrollHeight","400px","appendTo","body","formControlName","category_id_fk","optionLabel","category_name","optionValue","category_id","placeholder","Select Category ...","filterBy","category_name",3,"autoOptionFocus","showClear","options","filter"],[1,"flex","align-items-center","gap-1"],["formControlName","stock_management","inputId","stock_management",3,"binary"],["for","stock_management"],["class","field col-6",4,"ngIf"],["for","unit_price_usd"],["styleClass","w-full","formControlName","unit_price_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["for","product_notes"],["type","text","pInputText","","formControlName","product_notes","spellcheck","false",1,"w-full"],["pTemplate","footer"],["pButton","","pRipple","","label","New Item","icon","pi pi-plus",1,"p-button-success","mr-2","p-button-sm",3,"click"],["pButton","","pRipple","","label","Edit","icon","pi pi-file-edit",1,"p-button-warning","p-button-sm","mr-2",3,"click","disabled"],["pButton","","pRipple","","label","Delete","icon","pi pi-trash",1,"p-button-danger","p-button-sm",3,"click","disabled"],["width","20%"],["width","40%"],["width","10%"],["width","15%",4,"ngIf"],["width","15%"],[3,"pSelectableRow"],[4,"ngIf"],["colspan","5"],[1,"p-error"],[1,"field","col-4","flex","align-items-end"],["label","Generate","severity","contrast",3,"onClick"],["for","qty"],["styleClass","w-full","formControlName","low_stock_threshold","placeholder","low stock qty",1,"p-inputtext-sm","w-full"],["styleClass","w-full","formControlName","quantity","placeholder","Initial Qty",1,"p-inputtext-sm","w-full"],["for","unit_cost_usd"],["styleClass","w-full","formControlName","unit_cost_usd","inputId","currency-us","mode","currency","currency","USD","locale","en-US",1,"p-inputtext-sm","w-full",3,"ngClass"],["type","submit","pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-success","w-full","mb-3",3,"click","loading"],["pButton","","pRipple","","label","Close","icon","pi pi-times",1,"p-button-secondary","w-full",3,"click"]],template:function(r,i){if(r&1){let p=b();o(0,"p-panel",3),R(1,"titlecase"),o(2,"p-toolbar",4),_(3,Mn,1,0,"ng-template",5)(4,Bn,2,2,"ng-template",6),n(),o(5,"p-table",7,0),E("selectionChange",function(y){return d(p),T(i.selectedItem,y)||(i.selectedItem=y),u(y)}),_(7,Hn,10,1,"ng-template",8)(8,qn,11,8,"ng-template",9)(9,Gn,3,0,"ng-template",10),n()(),o(10,"p-sidebar",11),E("visibleChange",function(y){return d(p),T(i.itemSidebarVisible,y)||(i.itemSidebarVisible=y),u(y)}),g("onShow",function(){return d(p),u(i.focusInput())})("onHide",function(){return d(p),u(i.resetDialog())}),_(11,An,2,1,"ng-template",8),o(12,"form",12),g("ngSubmit",function(){return d(p),u(i.submitItem())}),o(13,"div",13)(14,"div",14)(15,"label",15),l(16,"Barcode"),n(),o(17,"p-inputGroup")(18,"p-inputGroupAddon"),f(19,"i",16),n(),o(20,"input",17,1),g("input",function(){return d(p),u(i.clearBarcodeError())}),n()(),_(22,Qn,2,0,"small",18),n(),_(23,jn,2,0,"div",19),o(24,"div",20)(25,"label",21),l(26,"Product Name"),o(27,"span",22),l(28,"*"),n()(),f(29,"input",23,2),_(31,zn,2,0,"small",18),n(),o(32,"div",24)(33,"label",25),l(34,"Category"),n(),f(35,"p-dropdown",26),n(),o(36,"div",24)(37,"label"),l(38,"Stock Management"),n(),f(39,"br"),o(40,"div",27),f(41,"p-checkbox",28),o(42,"label",29),l(43,"Enable"),n()()(),_(44,Un,5,1),n(),o(45,"div",13),_(46,Kn,7,4,"div",30),o(47,"div",24)(48,"label",31),l(49,"Unit price"),o(50,"span",22),l(51,"*"),n()(),f(52,"p-inputNumber",32),_(53,Yn,2,0,"small",18),n(),o(54,"div",20)(55,"label",33),l(56,"Notes"),n(),f(57,"input",34),n()()(),_(58,Jn,2,1,"ng-template",35),n()}r&2&&(ot("header",N(1,24,i.selectedCategory().category_name)),a(5),s("value",i.filteredItems()),I("selection",i.selectedItem),s("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(26,Nn))("alwaysShowPaginator",!1),a(5),I("visible",i.itemSidebarVisible),a(2),s("formGroup",i.itemForm),a(8),s("ngClass",x(27,Me,i.barcodeError)),a(2),s("ngIf",i.barcodeError),a(),s("ngIf",i.dialogMode=="add"||!(i.selectedItem!=null&&i.selectedItem.have_barcode)),a(6),s("ngClass",x(29,Me,i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted))),a(2),s("ngIf",i.product_name.invalid&&(i.product_name.dirty||i.product_name.touched||i.submitted)),a(4),s("autoOptionFocus",!1)("showClear",!0)("options",i.categories())("filter",!0),a(6),s("binary",!0),a(3),fe(i.stock_management.value?44:-1),a(2),s("ngIf",i.userPermissions().show_cost),a(6),s("ngClass",x(31,Me,i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted))),a(),s("ngIf",i.unit_price_usd.invalid&&(i.unit_price_usd.dirty||i.unit_price_usd.touched||i.submitted)))},dependencies:[Q,M,W,ae,j,z,U,Z,Y,V,J,X,ce,B,ke,me,pe,Pe,we,Ee,Ve,Te,gt,be]})}}return t})();function $n(t,c){t&1&&f(0,"category-items")}var ei=(()=>{class t{constructor(){this.stockService=C(D),this.selectedCategory=this.stockService.selectedCategory}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275cmp=w({type:t,selectors:[["app-categories-home"]],decls:5,vars:1,consts:[[1,"grid","m-1"],[1,"col-12","md:col-6"],[4,"ngIf"]],template:function(r,i){r&1&&(o(0,"div",0)(1,"div",1),f(2,"categories"),n(),o(3,"div",1),_(4,$n,1,0,"category-items",2),n()()),r&2&&(a(4),s("ngIf",i.selectedCategory()))},dependencies:[M,Xt,$t]})}}return t})();var eo=[{path:"",component:Kt,children:[{path:"items",data:{breadcrumb:"Inventory"},component:Zt},{path:"categories",data:{breadcrumb:"Categories"},component:ei},{path:"settings",data:{breadcrumb:"Settings"},component:Jt},{path:"**",redirectTo:"/stock/items"}]}],ti=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=ie({type:t})}static{this.\u0275inj=te({imports:[He.forChild(eo),He]})}}return t})();var aa=(()=>{class t{static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275mod=ie({type:t})}static{this.\u0275inj=te({imports:[ye,vt,St,ti,Ie,Nt,Se,xe,Dt,Tt,Ft,xt,Bt,jt,Vt,Qt,Ht,Ot,Ne,Lt,De]})}}return t})();export{aa as StockModule};
