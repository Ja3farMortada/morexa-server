import{a as re}from"./chunk-CM4NZ263.js";import{a as ee}from"./chunk-2IAGA2KS.js";import{j as ne,l as se,m as oe,p as ae,q as le}from"./chunk-CGG3ICFJ.js";import{Aa as E,B as v,Ba as F,Bc as te,Cc as ie,Db as H,Gb as R,Hb as L,Jb as Q,K as d,L as S,Nb as Y,R as w,Sb as U,Ta as A,U as h,Va as W,W as l,Wb as $,Yb as G,Z as V,_a as N,a as D,aa as s,ab as q,ba as a,c as M,ga as b,ha as _,hc as J,ia as r,ic as K,jc as X,kc as Z,m as I,na as P,oa as B,p as u,pa as k,q as T,ra as p,ub as z,v as j,va as g,w as m,wa as f,x as c,xa as x,za as O}from"./chunk-D4YDXMC2.js";var pe=(()=>{class n{constructor(){this.http=u(q),this.api=u(L),this.notificationService=u(R),this.cashBalanceService=u(ee),this.expensesAccounts=w([]),this.loading_table=w(!1),this.status_action$=new M({}),this.getExpensesAccounts()}getExpensesAccounts(){this.loading_table.set(!0),this.http.get(`${this.api.host()}/expense/accounts`).subscribe({next:e=>{this.expensesAccounts.set(e)},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpensePayment(e){this.loading_table.set(!0),this.http.post(`${this.api.host()}/expense/create`,e).subscribe({next:t=>{this.notificationService.showSuccess(t.message,"home"),this.status_action$.next({action:"ADD"}),this.cashBalanceService.getBalance()},error:t=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpenseEditPayment(e){this.loading_table.set(!0),this.http.put(`${this.api.host()}/expense`,e).subscribe({next:t=>{this.notificationService.showSuccess("Payment updated successfully","home"),this.status_action$.next({action:"UPDATE"}),this.cashBalanceService.getBalance()},error:t=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deletePayment(e){this.loading_table.set(!0),this.http.delete(`${this.api.host()}/expense/${e}`).subscribe({next:t=>{this.status_action$.next({action:"DELETE"}),this.cashBalanceService.getBalance()},error:t=>{this.loading_table.set(!1),this.notificationService.showError(t.error,"home")},complete:()=>{this.loading_table.set(!1),this.notificationService.showSuccess("Payment deleted successfully","home")}})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var de=["amountInput"],ue=()=>({width:"75vw"}),_e=()=>({"1199px":"85vw","575px":"95vw"}),he=n=>({"ng-invalid ng-dirty":n});function ge(n,y){n&1&&(s(0,"small",15),p(1,"Date is required."),a())}function fe(n,y){n&1&&(s(0,"small",15),p(1,"Ammount is required."),a())}function xe(n,y){if(n&1){let e=b();s(0,"div",4)(1,"div",5)(2,"div",6)(3,"label",7),p(4,"Description"),s(5,"span",8),p(6," *"),a()(),s(7,"input",9),x("ngModelChange",function(i){m(e);let o=r();return f(o.journal_description,i)||(o.journal_description=i),c(i)}),a()()(),s(8,"div",5)(9,"label",10),p(10,"Payment Date"),s(11,"span",8),p(12," *"),a()(),s(13,"p-calendar",11),x("ngModelChange",function(i){m(e);let o=r();return f(o.payment_date,i)||(o.payment_date=i),c(i)}),a(),h(14,ge,2,0,"small",12),a(),s(15,"div",5)(16,"div",6)(17,"label",13),p(18,"Amount"),s(19,"span",8),p(20," *"),a()(),s(21,"p-inputNumber",14,0),x("ngModelChange",function(i){m(e);let o=r();return f(o.amount,i)||(o.amount=i),c(i)}),_("onFocus",function(i){m(e);let o=r();return c(o.selectInput(i))}),a(),h(23,fe,2,0,"small",12),a()()()}if(n&2){let e=r();d(7),g("ngModel",e.journal_description),d(6),g("ngModel",e.payment_date),l("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showTime",!0),d(),l("ngIf",e.submitted&&!e.payment_date),d(7),g("ngModel",e.amount),l("required",!0)("ngClass",F(11,he,e.submitted&&!e.amount)),d(2),l("ngIf",e.submitted&&!e.amount)}}function ye(n,y){if(n&1){let e=b();s(0,"p-button",19),_("onClick",function(){m(e);let i=r(2);return c(i.deletePayment())}),a()}if(n&2){let e=r(2);l("disabled",e.loading())}}function be(n,y){if(n&1){let e=b();h(0,ye,1,1,"p-button",16),s(1,"p-button",17),_("onClick",function(){m(e);let i=r();return c(i.closeDialog())}),a(),s(2,"p-button",18),_("onClick",function(){m(e);let i=r();return c(i.submitPayment())}),a()}if(n&2){let e=r();l("ngIf",e.dialog_mode==="edit"),d(),l("disabled",e.loading()),d(),l("loading",e.loading())}}var Ke=(()=>{class n{constructor(e,t){this.expensesService=e,this.confirmationService=t,this.visible=!1,this.dialog_mode="add",this.OnClose=new v,this.OnSubmit=new v,this.dateService=u(re),this.expensesAccounts=this.expensesService.expensesAccounts,this.loading=this.expensesService.loading_table,this.submitted=!1,this.payment_date=this.dateService.getCurrentDatetime(),this.amount=null,this.subscriptions=new D}initDialog(){this.submitted=!1,this.amount=null,this.journal_description=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.expensesService.status_action$.subscribe(e=>{e.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment?(this.journal_description=this.selected_payment.journal_description,this.amount=this.selected_payment.total_value,this.payment_date=this.dateService.formatDate(this.selected_payment.payment_date,"YYYY-MM-DD HH:mm")):this.visible&&this.dialog_mode==="add"&&(this.payment_date=this.dateService.getCurrentDatetime())}deletePayment(){this.confirmationService.confirm({key:"home",message:'Are you sure that you want to delete invoice"?',header:"Warning",icon:"pi pi-exclamation-triangle",acceptButtonStyleClass:"p-button-danger",rejectButtonStyleClass:"p-button-secondary",defaultFocus:"reject",accept:()=>{this.expensesService.deletePayment(this.selected_payment.journal_id)}})}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&this.journal_description&&(this.payment_date=this.dateService.formatDate(this.payment_date),this.dialog_mode==="add"?this.expensesService.submitExpensePayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date}):this.expensesService.submitExpenseEditPayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id}))}selectInput(e){e.target.select()}static{this.\u0275fac=function(t){return new(t||n)(S(pe),S(z))}}static{this.\u0275cmp=T({type:n,selectors:[["expenses-dialog"]],viewQuery:function(t,i){if(t&1&&P(de,5),t&2){let o;B(o=k())&&(i.amountInput=o.first)}},inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[j,O],decls:3,vars:10,consts:[["amountInput",""],["position","top","header","Submit Expense","styleClass","p-fluid",3,"visibleChange","onHide","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],[1,"formgrid","grid"],[1,"field","col-12","md:col-4"],[1,"flex","flex-column","gap-2"],["for","Type"],[1,"text-red-500"],["type","text","pInputText","",3,"ngModelChange","ngModel"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","showTime"],["class","p-error",4,"ngIf"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","onFocus","ngModel","required","ngClass"],[1,"p-error"],["pRipple","","size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["pRipple","","size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","disabled"],["pRipple","","size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","loading"],["pRipple","","size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"onClick","disabled"]],template:function(t,i){t&1&&(s(0,"p-dialog",1),x("visibleChange",function(C){return f(i.visible,C)||(i.visible=C),C}),_("onHide",function(){return i.closeDialog()}),h(1,xe,24,13,"ng-template",2)(2,be,3,3,"ng-template",3),a()),t&2&&(V(E(8,ue)),l("modal",!0),g("visible",i.visible),l("breakpoints",E(9,_e))("closeOnEscape",!1)("closable",!0)("maximizable",!0))},dependencies:[ie,te,H,K,J,ne,le,ae,oe,se,G,Q,Y,$,U,N,A,W,Z,X]})}}return n})();export{Ke as a};
