import{a as f}from"./chunk-N4OSQ2YP.js";import{a as d}from"./chunk-7THMIGUD.js";import{b as m}from"./chunk-TAW6AXMG.js";import{Kb as l,Lb as u,U as e,d as c,eb as n,o as h,s as o}from"./chunk-4RWQR7BF.js";var p=class{constructor(){this.cost_dollar=0,this.subtotal_dollar=0,this.total_dollar=0,this.discount_dollar=0,this.discount2_dollar=0,this.total_dollar_discount_2=0,this.vat_dollar=0,this.total_qty=0}},_=function(t){return t.unit_price_usd="unit_price_usd",t}(_||{});var I=(()=>{class t{constructor(){this.http=o(n),this.apiService=o(u),this.notificationService=o(l),this.stockService=o(m),this.cashBalanceService=o(d),this.historyService=o(f),this.invoice=e([]),this.signal_submited=e(!1),this.submitCheckoutLoading=e(!1),this.reset$=new c(!1),this.factor=e(1),this.barcodeResponse=new c(null),this.products=this.stockService.products,this.selected_customer_id=e(null),this.payment_amount=e(0),this.journal_notes=e(null)}submitBarcode(i){let s=this.products().find(r=>r.barcode==i);s?this.barcodeResponse.next(s):this.notificationService.showError("Item not found!","home")}checkout(i,s){this.signal_submited.set(!0),this.submitCheckoutLoading.set(!0);let r=null;i.customer_id&&s&&(r={amount:s,customer_id:i.customer_id,payment_date:i.order_datetime}),this.http.post(`${this.apiService.host()}/sell-orders`,{invoice:i,payment:r}).subscribe({next:a=>{this.notificationService.showSuccess("Invoice submitted","home")},error:a=>{this.notificationService.showError(a.error.message,"home"),this.submitCheckoutLoading.set(!1)},complete:()=>{this.stockService.getItems(),this.invoice.set([]),this.signal_submited.set(!1),this.submitCheckoutLoading.set(!1),this.reset$.next(!0),this.cashBalanceService.getBalance(),this.historyService.fetchSalesHistory()}})}static{this.\u0275fac=function(s){return new(s||t)}}static{this.\u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{p as a,_ as b,I as c};
